{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapActions } from \"vuex\";\nexport default {\n  name: \"EditCupon\",\n  data() {\n    return {\n      optionsAct: false,\n      optionsAct2: false,\n      optionsAct3: false,\n      optionsAct4: false,\n      optionsAct5: false,\n      optionsAct6: false,\n      viewModal: false,\n      name: \"\",\n      descrp: \"\",\n      code: \"\",\n      cstatus: \"INACTIVO\",\n      date_a: \"\",\n      date_b: \"\",\n      freeShipping: \"NO\",\n      totalAvailable: 0,\n      totalAvailableCustomer: 1,\n      minAmount: 0,\n      maxAmount: 0,\n      type: \"PORCENTAJE\",\n      value: 0,\n      resCus: \"NO\",\n      resProd: \"NO\",\n      resCat: \"NO\",\n      limitCustomers: \"NO\",\n      ExcludeCustomers: \"NO\",\n      limitCategories: \"NO\",\n      ExcludeCategories: \"NO\",\n      limitProducts: \"NO\",\n      ExcludeProducts: \"NO\",\n      couponRestrictionsCustomers: [],\n      couponRestrictionsProducts: [],\n      couponRestrictionsCategories: [],\n      cus_email: \"\",\n      cat_name: \"\",\n      prod_name: \"\",\n      status: \"\",\n      msg: \"\",\n      exclusivo: false,\n      currentPage: 1,\n      itemsPerPage: 4,\n      currentPage2: 1,\n      itemsPerPage2: 4\n    };\n  },\n  created() {\n    this.getAllInfoCat(\"category\");\n    this.getAllInfoPro(\"product\");\n    this.getAllInfoCar2(\"cupones\");\n  },\n  computed: {\n    cupones() {\n      return this.$store.getters[\"shopcar/data2\"];\n    },\n    data() {\n      //return this.$store.getters[\"shopcar/getAdded\"];\n      let cupon = this.$store.getters[\"shopcar/getAdded\"];\n      if (cupon.exclusivo == 'NO') {\n        cupon.exclusivo = false;\n      } else {\n        cupon.exclusivo = true;\n      }\n      if (cupon.limitCustomers == \"SI\" || cupon.ExcludeCustomers == \"SI\") {\n        let items = [];\n        let arr = cupon.restrictions_customers;\n        if (arr != \"No se encontraron coincidencias\") {\n          for (var i = 0; i < arr.length; i++) {\n            let model = {\n              id: arr[i].id,\n              name: arr[i].customer_email\n            };\n            items.push(model);\n          }\n        }\n        this.couponRestrictionsCustomers = items;\n        if (cupon.limitCustomers == \"SI\") {\n          this.resCus = \"LIMITAR\";\n        } else {\n          this.resCus = \"EXCLUIR\";\n        }\n      } else {\n        this.resCus = \"NO\";\n      }\n      if (cupon.limitCategories == \"SI\" || cupon.ExcludeCategories == \"SI\") {\n        let items = [];\n        let arr = cupon.restrictions_categories;\n        if (arr != \"No se encontraron coincidencias\") {\n          for (var i = 0; i < arr.length; i++) {\n            let model = {\n              id: arr[i].id,\n              name: arr[i].category\n            };\n            items.push(model);\n          }\n        }\n        this.couponRestrictionsCategories = items;\n        if (cupon.limitCategories == \"SI\") {\n          this.resCat = \"LIMITAR\";\n        } else {\n          this.resCat = \"EXCLUIR\";\n        }\n      } else {\n        this.resCat = \"NO\";\n      }\n      if (cupon.limitProducts == \"SI\" || cupon.ExcludeProducts == \"SI\") {\n        let items = [];\n        let arr = cupon.restrictions_products;\n        if (arr != \"No se encontraron coincidencias\") {\n          for (var i = 0; i < arr.length; i++) {\n            let model = {\n              id: arr[i].id,\n              name: arr[i].product\n            };\n            items.push(model);\n          }\n        }\n        this.couponRestrictionsProducts = items;\n        if (cupon.limitProducts == \"SI\") {\n          this.resProd = \"LIMITAR\";\n        } else {\n          this.resProd = \"EXCLUIR\";\n        }\n      } else {\n        this.resProd = \"NO\";\n      }\n      return cupon;\n    },\n    products() {\n      return this.$store.getters[\"product/data\"];\n    },\n    categorias() {\n      let allctg = this.$store.getters[\"category/data\"];\n      let result = [];\n      if (allctg != 'No se encontraron coincidencias' && allctg != 'error') {\n        for (var i = 0; i < allctg.length; i++) {\n          if (allctg[i].id != 1) {\n            result.push(allctg[i]);\n          }\n        }\n      }\n      return result;\n    },\n    url() {\n      return this.$store.getters[\"main/baseURL\"];\n    },\n    user() {\n      return this.$store.getters[\"admin/getIdentity\"];\n    },\n    //Paginacion productos\n\n    allItems() {\n      return Object.keys(this.products).map(pid => this.products[pid]);\n    },\n    filteredItems() {\n      return this.allItems.slice((this.currentPage - 1) * this.itemsPerPage, this.currentPage * this.itemsPerPage);\n    },\n    totalPages() {\n      let total = Math.ceil(this.allItems.length / this.itemsPerPage);\n      if (total < this.currentPage) {\n        this.currentPage = 1;\n      }\n      return total;\n    },\n    allItems2() {\n      return Object.keys(this.categorias).map(pid => this.categorias[pid]);\n    },\n    filteredItems2() {\n      return this.allItems2.slice((this.currentPage2 - 1) * this.itemsPerPage2, this.currentPage2 * this.itemsPerPage2);\n    },\n    totalPages2() {\n      let total = Math.ceil(this.allItems2.length / this.itemsPerPage2);\n      if (total < this.currentPage2) {\n        this.currentPage2 = 1;\n      }\n      return total;\n    }\n  },\n  methods: {\n    ...mapActions(\"shopcar\", [\"setAddedCar\"]),\n    ...mapActions(\"shopcar\", [\"getAllInfoCar\"]),\n    ...mapActions(\"shopcar\", [\"getAllInfoCar2\"]),\n    ...mapActions(\"shopcar\", [\"setHistoryOptionCar\"]),\n    ...mapActions(\"shopcar\", [\"getInfoByIdCar\"]),\n    ...mapActions(\"main\", [\"getAllInfo\"]),\n    ...mapActions(\"product\", [\"getAllInfoPro\"]),\n    ...mapActions(\"category\", [\"getAllInfoCat\"]),\n    wait: function () {\n      setTimeout(() => this.$router.go(), 200);\n    },\n    submit: async function (name, descrp, code, cstatus, date_a, date_b, freeShipping, totalAvailable, totalAvailableCustomer, minAmount, maxAmount, type, value, limitCustomers, ExcludeCustomers, limitCategories, ExcludeCategories, limitProducts, ExcludeProducts, couponRestrictionsCustomers, couponRestrictionsProducts, couponRestrictionsCategories, exclusivo) {\n      if (couponRestrictionsCustomers.length == 0 && (limitCustomers == \"SI\" || ExcludeCustomers == \"SI\")) {\n        this.status = \"error\";\n        this.msg = \"Falta agregar los clientes a los que desea aplicar la restricción.\";\n      } else if (couponRestrictionsProducts.length == 0 && (limitProducts == \"SI\" || ExcludeProducts == \"SI\")) {\n        this.status = \"error\";\n        this.msg = \"Falta agregar los productos a los que desea aplicar la restricción.\";\n      } else if (couponRestrictionsCategories.length == 0 && (limitCategories == \"SI\" || ExcludeCategories == \"SI\")) {\n        this.status = \"error\";\n        this.msg = \"Falta agregar las categorias a las que desea aplicar la restricción.\";\n      } else if (date_a >= date_b) {\n        this.status = \"error\";\n        this.msg = \"La fecha inicial no debe ser mayor o igual a la de expiración.\";\n      } else {\n        let reorder1 = [];\n        let reorder2 = [];\n        let reorder3 = [];\n        for (var i = 0; i < couponRestrictionsCustomers.length; i++) {\n          reorder1.push(couponRestrictionsCustomers[i].name);\n        }\n        for (var k = 0; k < couponRestrictionsProducts.length; k++) {\n          reorder2.push(couponRestrictionsProducts[k].name);\n        }\n        for (var m = 0; m < couponRestrictionsCategories.length; m++) {\n          reorder3.push(couponRestrictionsCategories[m].name);\n        }\n        let id = this.data.id;\n        exclusivo == true ? exclusivo = 'SI' : exclusivo = 'NO';\n        let data = {\n          id: id,\n          name: name,\n          descrp: descrp,\n          code: code,\n          cstatus: cstatus,\n          date_a: date_a,\n          date_b: date_b,\n          freeShipping: freeShipping,\n          totalAvailable: totalAvailable,\n          totalAvailableCustomer: totalAvailableCustomer,\n          minAmount: minAmount,\n          maxAmount: maxAmount,\n          type: type,\n          value: value,\n          limitCustomers: limitCustomers,\n          ExcludeCustomers: ExcludeCustomers,\n          limitCategories: limitCategories,\n          ExcludeCategories: ExcludeCategories,\n          limitProducts: limitProducts,\n          ExcludeProducts: ExcludeProducts,\n          couponRestrictionsCustomers: reorder1,\n          couponRestrictionsProducts: reorder2,\n          couponRestrictionsCategories: reorder3,\n          exclusivo\n        };\n        this.status = \"\";\n        this.msg = \"\";\n        let result = await this.$store.dispatch(\"main/editItem\", {\n          option: \"cupon\",\n          item: data\n        });\n        if (result.status == \"error\") {\n          this.status = \"error\";\n          this.msg = result.message;\n        } else {\n          // success\n\n          this.showModal();\n        }\n      }\n    },\n    showModal: function () {\n      this.viewModal = true;\n    },\n    eliminarItem: async function (id, option) {\n      let result = await this.$store.dispatch(\"main/deleteItem\", {\n        option: option,\n        id: id\n      });\n      if (result.status == \"error\") {\n        this.msg = result.message;\n        this.status = \"error\";\n      } else {\n        this.msg = result.message;\n        this.status = \"success\";\n      }\n    },\n    back: function () {\n      setTimeout(() => this.$router.go(), 200);\n    },\n    codeCreate() {\n      let cupones = this.cupones;\n      this.code = \"\";\n      var ctrs = \"ABCDEFGHJKLMNOPQRTUVWXYZ123456789\";\n      var codeGen = \"\";\n      let valido = false;\n      while (valido == false) {\n        for (var k = 0; k < 20; k++) {\n          codeGen += ctrs.charAt(Math.floor(Math.random() * ctrs.length));\n        }\n        let encontrado = \"no\";\n        for (var i = 0; i < cupones.length; i++) {\n          if (cupones[i].code == codeGen) {\n            encontrado = \"si\";\n          }\n        }\n        if (encontrado == \"si\") {\n          codeGen = \"\";\n        } else {\n          valido = true;\n        }\n      }\n      this.code = codeGen;\n      return codeGen;\n    },\n    changeRCus: function (value) {\n      this.resCus = value;\n      if (value == 'NO') {\n        this.data.limitCustomers = 'NO';\n        this.data.ExcludeCustomers = 'NO';\n        this.data.couponRestrictionsCustomers = [];\n      }\n      if (value == 'LIMITAR') {\n        this.data.limitCustomers = 'SI';\n        this.data.ExcludeCustomers = 'NO';\n      }\n      if (value == 'EXCLUIR') {\n        this.data.limitCustomers = 'NO';\n        this.data.ExcludeCustomers = 'SI';\n      }\n    },\n    añadirCus(email) {\n      this.status = \"\";\n      this.msg = \"\";\n      if (this.resCus == \"NO\") {\n        this.status = \"error\";\n        this.msg = \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\n      } else if (email == undefined || email == \"\") {\n        this.status = \"error\";\n        this.msg = \"Agrege un email valido.\";\n      } else {\n        let items = [];\n        let res = this.couponRestrictionsCustomers;\n        for (var i = 0; i < res.length; i++) {\n          let model = {\n            id: res[i].id,\n            name: res[i].name\n          };\n          items.push(model);\n        }\n        let encontrado = \"NO\";\n        for (var k = 0; k < items.length; k++) {\n          if (items[k].name == email) {\n            encontrado = \"SI\";\n          }\n        }\n        if (encontrado == \"NO\") {\n          items.push({\n            id: null,\n            name: email\n          });\n        } else {\n          this.status = \"error\";\n          this.msg = \"Email ya agregado.\";\n        }\n        this.couponRestrictionsCustomers = items;\n        this.cus_email = \"\";\n      }\n    },\n    delRcus(key) {\n      let items = [];\n      let res = this.couponRestrictionsCustomers;\n      for (var i = 0; i < res.length; i++) {\n        if (i != key) {\n          let model = {\n            id: res[i].id,\n            name: res[i].name\n          };\n          items.push(model);\n        } else {\n          if (res[i].id != null && res[i].id != undefined) {\n            this.eliminarItem(res[i].id, \"rcustomer\");\n          }\n        }\n      }\n      this.couponRestrictionsCustomers = items;\n    },\n    changeRCat: function (value) {\n      this.resCat = value;\n      if (value == 'NO') {\n        this.data.limitCategories = 'NO';\n        this.data.ExcludeCategories = 'NO';\n        this.data.couponRestrictionsCategories = [];\n      }\n      if (value == 'LIMITAR') {\n        this.data.limitCategories = 'SI';\n        this.data.ExcludeCategories = 'NO';\n      }\n      if (value == 'EXCLUIR') {\n        this.data.limitCategories = 'NO';\n        this.data.ExcludeCategories = 'SI';\n      }\n    },\n    añadirCat(categoria) {\n      this.status = \"\";\n      this.msg = \"\";\n      if (this.resCat == \"NO\") {\n        this.status = \"error\";\n        this.msg = \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\n      } else if (categoria == undefined || categoria == \"\") {\n        this.status = \"error\";\n        this.msg = \"Agrege una categoría valida.\";\n      } else {\n        let cate = this.categorias;\n        let isvalid = \"NO\";\n        for (var i = 0; i < cate.length; i++) {\n          if (cate[i].name == categoria) {\n            isvalid = \"SI\";\n          }\n        }\n        if (isvalid == \"SI\") {\n          let items = [];\n          let res = this.couponRestrictionsCategories;\n          for (var i = 0; i < res.length; i++) {\n            let model = {\n              id: res[i].id,\n              name: res[i].name\n            };\n            items.push(model);\n          }\n          let encontrado = \"NO\";\n          for (var k = 0; k < items.length; k++) {\n            if (items[k].name == categoria) {\n              encontrado = \"SI\";\n            }\n          }\n          if (encontrado == \"NO\") {\n            items.push({\n              id: null,\n              name: categoria\n            });\n          } else {\n            this.status = \"error\";\n            this.msg = \"Categoría ya agregada.\";\n          }\n          this.couponRestrictionsCategories = items;\n          //this.cat_name = \"\";\n        } else {\n          this.status = \"error\";\n          this.msg = \"Categoría no encontrada.\";\n          //this.cat_name = \"\";\n        }\n      }\n    },\n\n    delRcat(key) {\n      let items = [];\n      let res = this.couponRestrictionsCategories;\n      for (var i = 0; i < res.length; i++) {\n        if (i != key) {\n          let model = {\n            id: res[i].id,\n            name: res[i].name\n          };\n          items.push(model);\n        } else {\n          if (res[i].id != null && res[i].id != undefined) {\n            this.eliminarItem(res[i].id, \"rcategory\");\n          }\n        }\n      }\n      this.couponRestrictionsCategories = items;\n    },\n    changeRProd: function (value) {\n      this.resProd = value;\n      if (value == 'NO') {\n        this.data.limitProducts = 'NO';\n        this.data.ExcludeProducts = 'NO';\n        this.couponRestrictionsProducts = [];\n      }\n      if (value == 'LIMITAR') {\n        this.data.limitProducts = 'SI';\n        this.data.ExcludeProducts = 'NO';\n      }\n      if (value == 'EXCLUIR') {\n        this.data.limitProducts = 'NO';\n        this.data.ExcludeProducts = 'SI';\n      }\n    },\n    añadirProd(producto) {\n      this.status = \"\";\n      this.msg = \"\";\n      if (this.resProd == \"NO\") {\n        this.status = \"error\";\n        this.msg = \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\n      } else if (producto == undefined || producto == \"\") {\n        this.status = \"error\";\n        this.msg = \"Agrege una categoría valida.\";\n      } else {\n        let prods = this.products;\n        let isvalid = \"NO\";\n        for (var i = 0; i < prods.length; i++) {\n          if (prods[i].name == producto) {\n            isvalid = \"SI\";\n          }\n        }\n        if (isvalid == \"SI\") {\n          let items = [];\n          let res = this.couponRestrictionsProducts;\n          for (var i = 0; i < res.length; i++) {\n            let model = {\n              id: res[i].id,\n              name: res[i].name\n            };\n            items.push(model);\n          }\n          let encontrado = \"NO\";\n          for (var k = 0; k < items.length; k++) {\n            if (items[k].name == producto) {\n              encontrado = \"SI\";\n            }\n          }\n          if (encontrado == \"NO\") {\n            items.push({\n              id: null,\n              name: producto\n            });\n          } else {\n            this.status = \"error\";\n            this.msg = \"Producto ya agregado.\";\n          }\n          this.couponRestrictionsProducts = items;\n          this.prod_name = \"\";\n        } else {\n          this.status = \"error\";\n          this.msg = \"Producto no encontrado.\";\n          this.prod_name = \"\";\n        }\n      }\n    },\n    delRprod(key) {\n      let items = [];\n      let res = this.couponRestrictionsProducts;\n      for (var i = 0; i < res.length; i++) {\n        if (i != key) {\n          let model = {\n            id: res[i].id,\n            name: res[i].name\n          };\n          items.push(model);\n        } else {\n          if (res[i].id != null && res[i].id != undefined) {\n            this.eliminarItem(res[i].id, \"rproduct\");\n          }\n        }\n      }\n      this.couponRestrictionsProducts = items;\n    }\n  }\n};","map":{"version":3,"mappings":";AAyiBA;AACA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEAR;MACAS;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAGAC;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACA;IACA;IACA;EAEA;EACAC;IACAC;MACA;IACA;IAEA5C;MACA;MACA;MACA;QACA6C;MACA;QACAA;MACA;MAEA;QACA;QAEA;QACA;UACA;YACA;cACAC;cACA/C;YACA;YAEAgD;UACA;QACA;QAEA;QAEA;UACA;QACA;UACA;QACA;MACA;QACA;MACA;MAEA;QACA;QACA;QACA;UACA;YACA;cACAD;cACA/C;YACA;YAEAgD;UACA;QACA;QAEA;QAEA;UACA;QACA;UACA;QACA;MACA;QACA;MACA;MAEA;QACA;QACA;QACA;UACA;YACA;cACAD;cACA/C;YACA;YAEAgD;UACA;QACA;QAEA;QAEA;UACA;QACA;UACA;QACA;MACA;QACA;MACA;MAEA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MAEA;QACA;UACA;YACAC;UACA;QAEA;MACA;MAGA;IAGA;IACAC;MACA;IACA;IACAC;MACA;IACA;IAEA;;IAEAC;MACA;IACA;IACAC;MACA,2BACA,4CACA,qCACA;IACA;IACAC;MACA;MACA;QACA;MACA;MACA;IACA;IAEAC;MACA;IACA;IACAC;MACA,4BACA,8CACA,uCACA;IACA;IACAC;MACA;MACA;QACA;MACA;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEAC;MACAC;IACA;IACAC,wBACA/D,MACAS,QACAC,MACAC,SACAC,QACAC,QACAC,cACAC,gBACAC,wBACAC,WACAC,WACAC,MACAC,OACAI,gBACAC,kBACAC,iBACAC,mBACAC,eACAC,iBACAC,6BACAC,4BACAC,8BACAM,WACA;MACA,IACAR,4CACAN,qDACA;QACA;QACA,WACA;MACA,WACAO,2CACAH,mDACA;QACA;QACA,WACA;MACA,WACAI,6CACAN,uDACA;QACA;QACA,WACA;MACA;QACA;QACA,WACA;MACA;QACA;QACA;QACA;QAEA;UACAsC;QACA;QAEA;UACAC;QACA;QAEA;UACAC;QACA;QAEA;QACA5B;QACA;UACAS;UACA/C;UACAS;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAI;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAM;QACA;QAEA;QACA;QAEA;UACA6B;UACAC;QACA;QAEA;UACA;UACA;QACA;UACA;;UAEA;QACA;MACA;IACA;IAOAC;MACA;IACA;IAEAC;MACA;QACAH;QACApB;MACA;MAEA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAwB;MACAT;IACA;IAGAU;MACA;MACA;MAEA;MACA;MAEA;MACA;QACA;UACAC;QACA;QAEA;QACA;UACA;YACAC;UACA;QACA;QAEA;UACAD;QACA;UACAE;QACA;MACA;MAEA;MAEA;IACA;IAEAC;MACA;MACA;QACA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;IAEA;IAEAC;MACA;MACA;MAEA;QACA;QACA,WACA;MACA;QACA;QACA;MACA;QACA;QACA;QAEA;UACA;YACA9B;YACA/C;UACA;UAEAgD;QACA;QAEA;QAEA;UACA;YACA0B;UACA;QACA;QAEA;UACA1B;YAAAD;YAAA/C;UAAA;QACA;UACA;UACA;QACA;QAEA;QACA;MACA;IACA;IAEA8E;MACA;MACA;MAEA;QACA;UACA;YACA/B;YACA/C;UACA;UACAgD;QACA;UACA;YACA;UACA;QACA;MACA;MAEA;IACA;IAIA+B;MACA;MACA;QACA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;IAEA;IAEAC;MACA;MACA;MAEA;QACA;QACA,WACA;MACA;QACA;QACA;MACA;QACA;QACA;QACA;UACA;YACAC;UACA;QACA;QAEA;UACA;UACA;UAEA;YACA;cACAlC;cACA/C;YACA;YAEAgD;UACA;UAEA;UAEA;YACA;cACA0B;YACA;UACA;UAEA;YACA1B;cAAAD;cAAA/C;YAAA;UACA;YACA;YACA;UACA;UAEA;UACA;QACA;UACA;UACA;UACA;QACA;MACA;IACA;;IAEAkF;MACA;MACA;MAEA;QACA;UACA;YACAnC;YACA/C;UACA;UACAgD;QACA;UACA;YACA;UACA;QACA;MACA;MAEA;IACA;IAEAmC;MACA;MACA;QACA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;IAEA;IAEAC;MACA;MACA;MAEA;QACA;QACA,WACA;MACA;QACA;QACA;MACA;QACA;QACA;QACA;UACA;YACAH;UACA;QACA;QAEA;UACA;UACA;UAEA;YACA;cACAlC;cACA/C;YACA;YAEAgD;UACA;UAEA;UAEA;YACA;cACA0B;YACA;UACA;UAEA;YACA1B;cAAAD;cAAA/C;YAAA;UACA;YACA;YACA;UACA;UAEA;UACA;QACA;UACA;UACA;UACA;QACA;MACA;IACA;IAEAqF;MACA;MACA;MAEA;QACA;UACA;YACAtC;YACA/C;UACA;UACAgD;QACA;UACA;YACA;UACA;QACA;MACA;MAEA;IACA;EACA;AACA","names":["name","data","optionsAct","optionsAct2","optionsAct3","optionsAct4","optionsAct5","optionsAct6","viewModal","descrp","code","cstatus","date_a","date_b","freeShipping","totalAvailable","totalAvailableCustomer","minAmount","maxAmount","type","value","resCus","resProd","resCat","limitCustomers","ExcludeCustomers","limitCategories","ExcludeCategories","limitProducts","ExcludeProducts","couponRestrictionsCustomers","couponRestrictionsProducts","couponRestrictionsCategories","cus_email","cat_name","prod_name","status","msg","exclusivo","currentPage","itemsPerPage","currentPage2","itemsPerPage2","created","computed","cupones","cupon","id","items","products","categorias","result","url","user","allItems","filteredItems","totalPages","allItems2","filteredItems2","totalPages2","methods","wait","setTimeout","submit","reorder1","reorder2","reorder3","option","item","showModal","eliminarItem","back","codeCreate","codeGen","encontrado","valido","changeRCus","añadirCus","delRcus","changeRCat","añadirCat","isvalid","delRcat","changeRProd","añadirProd","delRprod"],"sourceRoot":"src/views/shopcar","sources":["EditCupon.vue"],"sourcesContent":["<template >\r\n  <div id=\"AddCat\">\r\n    <div class=\"form-content\">\r\n      <form\r\n        @submit.prevent=\"\r\n          submit(\r\n            data.name,\r\n            data.descrp,\r\n            data.code,\r\n            data.status,\r\n            data.date_a,\r\n            data.date_b,\r\n            data.freeShipping,\r\n            data.totalAvailable,\r\n            data.totalAvailableCustomer,\r\n            data.minAmount,\r\n            data.maxAmount,\r\n            data.type,\r\n            data.value,\r\n            data.limitCustomers,\r\n            data.ExcludeCustomers,\r\n            data.limitCategories,\r\n            data.ExcludeCategories,\r\n            data.limitProducts,\r\n            data.ExcludeProducts,\r\n            couponRestrictionsCustomers,\r\n            couponRestrictionsProducts,\r\n            couponRestrictionsCategories,\r\n            data.exclusivo\r\n          )\r\n        \"\r\n      >\r\n\r\n     \r\n        <div class=\"grup-form dflx\">\r\n          <!--nombre-->\r\n          <div class=\"boxform\">\r\n            <label for=\"name\" class=\"name\">Nombre </label>\r\n            <input\r\n              v-model=\"data.name\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"name\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n            <div class=\"boxform\">\r\n             <label for=\"exclusivo\" class=\"exclusivo\">Exclusivo : <span v-if=\"data.exclusivo\">SI</span> <span v-else>NO</span> </label>\r\n             <input type=\"checkbox\" id=\"exclusivo\"  v-model=\"data.exclusivo\" >\r\n          </div>\r\n        </div>\r\n\r\n        <!--categoría-->\r\n        <div class=\"grup-form dflx\">\r\n          <div class=\"boxform\">\r\n            <label for=\"url\" class=\"url\">Descripcion </label>\r\n            <textarea\r\n              v-model=\"data.descrp\"\r\n              id=\"name\"\r\n              name=\"descrp\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              style=\"resize: none\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--codigo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">Codigo </label>\r\n            <input\r\n              v-model=\"data.code\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"code\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n            <p class=\"gencode\" @click=\"codeCreate()\">GENERAR CÓDIGO &#11119;</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">Fecha </label>\r\n            <input\r\n              v-model=\"data.date_a\"\r\n              type=\"date\"\r\n              id=\"name\"\r\n              name=\"date_a\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">Fecha Exp. </label>\r\n            <input\r\n              v-model=\"data.date_b\"\r\n              type=\"date\"\r\n              id=\"name\"\r\n              name=\"date_b\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--estatus-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">Estatus </label>\r\n            <input\r\n              v-model=\"data.status\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"cstatus\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct }\"\r\n              @click=\"optionsAct = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct }\"\r\n              @click=\"optionsAct = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"data.status = 'INACTIVO'\">\r\n                INACTIVO\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"data.status = 'ACTIVO'\">\r\n                ACTIVO\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!--estatus-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">ENVÍO GRATIS </label>\r\n            <input\r\n              v-model=\"data.freeShipping\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"freeShipping\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct2 }\"\r\n              @click=\"optionsAct2 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct2 }\"\r\n              @click=\"optionsAct2 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"data.freeShipping = 'SI'\">SI</div>\r\n              <div class=\"option-btn\" @click=\"data.freeShipping = 'NO'\">NO</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--total-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">TOTAL DISPONIBLE </label>\r\n            <input\r\n              v-model=\"data.totalAvailable\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"totalAvailable\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n          <!--available total-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">NÚM. USOS POR CLIENTE </label>\r\n            <input\r\n              v-model=\"data.totalAvailableCustomer\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"totalAvailableCustomer\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">VALOR </label>\r\n            <input\r\n              v-model=\"data.value\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"totalAvailable\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n          <!--tipo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">ENVÍO GRATIS </label>\r\n            <input\r\n              v-model=\"data.type\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"freeShipping\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct3 }\"\r\n              @click=\"optionsAct3 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct3 }\"\r\n              @click=\"optionsAct3 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"data.type = 'IMPORTE'\">\r\n                IMPORTE\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"data.type = 'PORCENTAJE'\">\r\n                PORCENTAJE\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">IMPORTE MÍNIMO</label>\r\n            <input\r\n              v-model=\"data.minAmount\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"minAmount\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">IMPORTE MÁXIMO </label>\r\n            <input\r\n              v-model=\"data.maxAmount\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"maxAmount\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <p class=\"prest\">RESTRICCIONES</p>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--tipo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"resCus\" class=\"code\">RESTRICCIÓN CLIENTE {{resCus}} </label>\r\n            <input\r\n              v-model=\"resCus\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"resCus\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct4 }\"\r\n              @click=\"optionsAct4 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct4 }\"\r\n              @click=\"optionsAct4 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"changeRCus('LIMITAR')\">\r\n                LIMITAR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRCus('EXCLUIR')\">\r\n                EXCLUIR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRCus('NO')\">NO</div>\r\n            </div>\r\n            <div class=\"grup-form dflx\" v-if=\"resCus != 'NO'\">\r\n              <div class=\"boxform\">\r\n                <label for=\"code\" class=\"code\">Añadir email</label>\r\n                <input\r\n                  v-model=\"cus_email\"\r\n                  type=\"email\"\r\n                  id=\"cus_email\"\r\n                  name=\"totalAvailableCustomer\"\r\n                  \r\n                  class=\"in1\"\r\n                />\r\n                <p class=\"alta\" @click=\"añadirCus(cus_email)\">AÑADIR</p>\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          couponRestrictionsCustomers !=\r\n                            'No se encontraron coincidencias.' &&\r\n                          couponRestrictionsCustomers != 'error'\r\n                        \"\r\n                      >\r\n                        <div\r\n                          v-for=\"(prm, key) in couponRestrictionsCustomers\"\r\n                          :key=\"key\"\r\n                          class=\"dflx sbtw\"\r\n                        >\r\n                          <!--<p class=\"itemp cp dflx\">-->\r\n                          <p class=\"item1\">{{ key }}</p>\r\n                          <p class=\"item2\">{{ prm.name }}</p>\r\n                          <p class=\"item3 pointer\" @click=\"delRcus(key)\">X</p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!--tipo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"resCat\" class=\"code\">RESTRICCIÓN CATEGORÍA </label>\r\n            <input\r\n              v-model=\"resCat\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"resCat\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct5 }\"\r\n              @click=\"optionsAct5 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct5 }\"\r\n              @click=\"optionsAct5 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"changeRCat('LIMITAR')\">\r\n                LIMITAR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRCat('EXCLUIR')\">\r\n                EXCLUIR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRCat('NO')\">NO</div>\r\n            </div>\r\n            <div class=\"grup-form dflx\" v-if=\"resCat != 'NO'\">\r\n              <!--categoría-->\r\n              <div class=\"boxform\">\r\n                <label for=\"role\" class=\"role\">Añadir categoría</label>\r\n\r\n                <!--<input\r\n              v-model=\"cat_name\"\r\n              type=\"text\"\r\n              id=\"tipos\"\r\n              name=\"tipos\"\r\n              disabled\r\n              required\r\n            />-->\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          categorias != 'No se encontraron coincidencias.' &&\r\n                          categorias != 'error'\r\n                        \"\r\n                      >\r\n                        <div v-for=\"(prm, key) in categorias\" :key=\"key\">\r\n                          <p class=\"itemp cp\" @click=\"añadirCat(prm.name)\">\r\n                            {{ prm.name }}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          couponRestrictionsCategories !=\r\n                            'No se encontraron coincidencias.' &&\r\n                          couponRestrictionsCategories != 'error'\r\n                        \"\r\n                      >\r\n                        <div\r\n                          v-for=\"(prm, key) in couponRestrictionsCategories\"\r\n                          :key=\"key\"\r\n                          class=\"dflx sbtw\"\r\n                        >\r\n                          <!--<p class=\"itemp cp dflx\">-->\r\n                          <p class=\"item1\">{{ key }}</p>\r\n                          <p class=\"item2\">{{ prm.name }}</p>\r\n                          <p class=\"item3 pointer\" @click=\"delRcat(key)\">X</p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!--tipo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"resProd\" class=\"code\">RESTRICCIÓN PRODUCTO </label>\r\n            <input\r\n              v-model=\"resProd\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"resProd\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct6 }\"\r\n              @click=\"optionsAct6 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct6 }\"\r\n              @click=\"optionsAct6 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"changeRProd('LIMITAR')\">\r\n                LIMITAR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRProd('EXCLUIR')\">\r\n                EXCLUIR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRProd('NO')\">NO</div>\r\n            </div>\r\n            <div class=\"grup-form dflx\" v-if=\"resProd != 'NO'\">\r\n              <!--producto-->\r\n              <div class=\"boxform\">\r\n                <label for=\"role\" class=\"role\">Añadir productos</label>\r\n\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          products != 'No se encontraron coincidencias.' &&\r\n                          products != 'error'\r\n                        \"\r\n                      >\r\n                        <div v-for=\"(prm, key) in products\" :key=\"key\">\r\n                          <p class=\"itemp cp\" @click=\"añadirProd(prm.name)\">\r\n                            {{ prm.name }}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          couponRestrictionsProducts !=\r\n                            'No se encontraron coincidencias.' &&\r\n                          couponRestrictionsProducts != 'error'\r\n                        \"\r\n                      >\r\n                        <div\r\n                          v-for=\"(prm, key) in couponRestrictionsProducts\"\r\n                          :key=\"key\"\r\n                          class=\"dflx sbtw\"\r\n                        >\r\n                          <!--<p class=\"itemp cp dflx\">-->\r\n                          <p class=\"item1\">{{ key }}</p>\r\n                          <p class=\"item2\">{{ prm.name }}</p>\r\n                          <p class=\"item3 pointer\" @click=\"delRprod(key)\">X</p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!--regresar/guardar-->\r\n        <div class=\"dflx\">\r\n          <p @click=\"wait()\" class=\"btnRegresar\">Regresar</p>\r\n          <button class=\"alta\" type=\"submit\">Guardar</button>\r\n        </div>\r\n\r\n        <div v-if=\"status != ''\" class=\"status_messages\">\r\n          <div v-if=\"status == 'success'\" class=\"msg msg_success\">\r\n            <p>{{ msg }}</p>\r\n          </div>\r\n          <div v-if=\"status == 'error'\" class=\"msg msg_error\">\r\n            <p>{{ msg }}</p>\r\n          </div>\r\n        </div>\r\n      </form>\r\n\r\n      <div v-if=\"viewModal\" class=\"modal_view\">\r\n      <div id=\"modal_edit\">\r\n        <div class=\"body dflx\">\r\n          <h3>Cupón actualizado</h3>\r\n          <img src=\"../../assets/add.png\" alt=\"icono alerta\" />\r\n        </div>\r\n\r\n        <div class=\"modal_edit_btns dflx\">\r\n          <p @click=\"wait()\" class=\"otro\">Aceptar</p>\r\n          <!-- <p  @click=\"back()\" class=\"inicio\">Inicio</p>-->\r\n        </div>\r\n      </div>\r\n    </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapActions } from \"vuex\";\r\nexport default {\r\n  name: \"EditCupon\",\r\n  data() {\r\n    return {\r\n      optionsAct: false,\r\n      optionsAct2: false,\r\n      optionsAct3: false,\r\n      optionsAct4: false,\r\n      optionsAct5: false,\r\n      optionsAct6: false,\r\nviewModal:false,\r\n\r\n      name: \"\",\r\n      descrp: \"\",\r\n      code: \"\",\r\n      cstatus: \"INACTIVO\",\r\n      date_a: \"\",\r\n      date_b: \"\",\r\n      freeShipping: \"NO\",\r\n      totalAvailable: 0,\r\n      totalAvailableCustomer: 1,\r\n      minAmount: 0,\r\n      maxAmount: 0,\r\n      type: \"PORCENTAJE\",\r\n      value: 0,\r\n      resCus: \"NO\",\r\n      resProd: \"NO\",\r\n      resCat: \"NO\",\r\n      limitCustomers: \"NO\",\r\n      ExcludeCustomers: \"NO\",\r\n      limitCategories: \"NO\",\r\n      ExcludeCategories: \"NO\",\r\n      limitProducts: \"NO\",\r\n      ExcludeProducts: \"NO\",\r\n      couponRestrictionsCustomers: [],\r\n      couponRestrictionsProducts: [],\r\n      couponRestrictionsCategories: [],\r\n      cus_email: \"\",\r\n      cat_name: \"\",\r\n      prod_name: \"\",\r\n      status: \"\",\r\n      msg: \"\",\r\n      exclusivo:false,\r\n     \r\n\r\n      currentPage: 1,\r\n      itemsPerPage: 4,\r\n      currentPage2: 1,\r\n      itemsPerPage2: 4,\r\n    };\r\n  },\r\n\r\n  created() {\r\n    this.getAllInfoCat(\"category\");\r\n    this.getAllInfoPro(\"product\");\r\n    this.getAllInfoCar2(\"cupones\");\r\n    \r\n  },\r\n  computed: {\r\n    cupones() {\r\n      return this.$store.getters[\"shopcar/data2\"];\r\n    },\r\n   \r\n    data() {\r\n      //return this.$store.getters[\"shopcar/getAdded\"];\r\n      let cupon = this.$store.getters[\"shopcar/getAdded\"];\r\n      if(cupon.exclusivo=='NO'){\r\n        cupon.exclusivo = false\r\n      }else{\r\n         cupon.exclusivo = true\r\n      }\r\n\r\n      if (cupon.limitCustomers == \"SI\" || cupon.ExcludeCustomers == \"SI\") {\r\n        let items = [];\r\n\r\n        let arr = cupon.restrictions_customers;\r\n        if (arr != \"No se encontraron coincidencias\") {\r\n          for (var i = 0; i < arr.length; i++) {\r\n            let model = {\r\n              id: arr[i].id,\r\n              name: arr[i].customer_email,\r\n            };\r\n\r\n            items.push(model);\r\n          }\r\n        }\r\n\r\n        this.couponRestrictionsCustomers = items;\r\n\r\n        if (cupon.limitCustomers == \"SI\") {\r\n          this.resCus = \"LIMITAR\";\r\n        } else {\r\n          this.resCus = \"EXCLUIR\";\r\n        }\r\n      } else {\r\n        this.resCus = \"NO\";\r\n      }\r\n\r\n      if (cupon.limitCategories == \"SI\" || cupon.ExcludeCategories == \"SI\") {\r\n        let items = [];\r\n        let arr = cupon.restrictions_categories;\r\n        if (arr != \"No se encontraron coincidencias\") {\r\n          for (var i = 0; i < arr.length; i++) {\r\n            let model = {\r\n              id: arr[i].id,\r\n              name: arr[i].category,\r\n            };\r\n\r\n            items.push(model);\r\n          }\r\n        }\r\n\r\n        this.couponRestrictionsCategories = items;\r\n\r\n        if (cupon.limitCategories == \"SI\") {\r\n          this.resCat = \"LIMITAR\";\r\n        } else {\r\n          this.resCat = \"EXCLUIR\";\r\n        }\r\n      } else {\r\n        this.resCat = \"NO\";\r\n      }\r\n\r\n      if (cupon.limitProducts == \"SI\" || cupon.ExcludeProducts == \"SI\") {\r\n        let items = [];\r\n        let arr = cupon.restrictions_products;\r\n        if (arr != \"No se encontraron coincidencias\") {\r\n          for (var i = 0; i < arr.length; i++) {\r\n            let model = {\r\n              id: arr[i].id,\r\n              name: arr[i].product,\r\n            };\r\n\r\n            items.push(model);\r\n          }\r\n        }\r\n\r\n        this.couponRestrictionsProducts = items;\r\n\r\n        if (cupon.limitProducts == \"SI\") {\r\n          this.resProd = \"LIMITAR\";\r\n        } else {\r\n          this.resProd = \"EXCLUIR\";\r\n        }\r\n      } else {\r\n        this.resProd = \"NO\";\r\n      }\r\n\r\n      return cupon;\r\n    },\r\n    products() {\r\n      return this.$store.getters[\"product/data\"];\r\n    },\r\n    categorias() {\r\n       let allctg = this.$store.getters[\"category/data\"];\r\n      let result = [];\r\n\r\n        if(allctg != 'No se encontraron coincidencias'  && allctg !='error'){\r\n          for (var i = 0; i < allctg.length; i++) {\r\n          if (allctg[i].id != 1) {\r\n          result.push(allctg[i])\r\n          } \r\n          \r\n          }\r\n        }\r\n     \r\n\r\n      return result;\r\n\r\n     \r\n    },\r\n    url() {\r\n      return this.$store.getters[\"main/baseURL\"];\r\n    },\r\n    user() {\r\n      return this.$store.getters[\"admin/getIdentity\"];\r\n    },\r\n\r\n    //Paginacion productos\r\n\r\n    allItems() {\r\n      return Object.keys(this.products).map((pid) => this.products[pid]);\r\n    },\r\n    filteredItems() {\r\n      return this.allItems.slice(\r\n        (this.currentPage - 1) * this.itemsPerPage,\r\n        this.currentPage * this.itemsPerPage\r\n      );\r\n    },\r\n    totalPages() {\r\n      let total = Math.ceil(this.allItems.length / this.itemsPerPage);\r\n      if (total < this.currentPage) {\r\n        this.currentPage = 1;\r\n      }\r\n      return total;\r\n    },\r\n\r\n    allItems2() {\r\n      return Object.keys(this.categorias).map((pid) => this.categorias[pid]);\r\n    },\r\n    filteredItems2() {\r\n      return this.allItems2.slice(\r\n        (this.currentPage2 - 1) * this.itemsPerPage2,\r\n        this.currentPage2 * this.itemsPerPage2\r\n      );\r\n    },\r\n    totalPages2() {\r\n      let total = Math.ceil(this.allItems2.length / this.itemsPerPage2);\r\n      if (total < this.currentPage2) {\r\n        this.currentPage2 = 1;\r\n      }\r\n      return total;\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapActions(\"shopcar\", [\"setAddedCar\"]),\r\n    ...mapActions(\"shopcar\", [\"getAllInfoCar\"]),\r\n    ...mapActions(\"shopcar\", [\"getAllInfoCar2\"]),\r\n    ...mapActions(\"shopcar\", [\"setHistoryOptionCar\"]),\r\n    ...mapActions(\"shopcar\", [\"getInfoByIdCar\"]),\r\n    ...mapActions(\"main\", [\"getAllInfo\"]),\r\n    ...mapActions(\"product\", [\"getAllInfoPro\"]),\r\n    ...mapActions(\"category\", [\"getAllInfoCat\"]),\r\n   \r\n    wait: function () {\r\n      setTimeout(() => this.$router.go(), 200);\r\n    },\r\n    submit: async function (\r\n      name,\r\n      descrp,\r\n      code,\r\n      cstatus,\r\n      date_a,\r\n      date_b,\r\n      freeShipping,\r\n      totalAvailable,\r\n      totalAvailableCustomer,\r\n      minAmount,\r\n      maxAmount,\r\n      type,\r\n      value,\r\n      limitCustomers,\r\n      ExcludeCustomers,\r\n      limitCategories,\r\n      ExcludeCategories,\r\n      limitProducts,\r\n      ExcludeProducts,\r\n      couponRestrictionsCustomers,\r\n      couponRestrictionsProducts,\r\n      couponRestrictionsCategories,\r\n      exclusivo\r\n    ) {\r\n      if (\r\n        couponRestrictionsCustomers.length == 0 &&\r\n        (limitCustomers == \"SI\" || ExcludeCustomers == \"SI\")\r\n      ) {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Falta agregar los clientes a los que desea aplicar la restricción.\";\r\n      } else if (\r\n        couponRestrictionsProducts.length == 0 &&\r\n        (limitProducts == \"SI\" || ExcludeProducts == \"SI\")\r\n      ) {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Falta agregar los productos a los que desea aplicar la restricción.\";\r\n      } else if (\r\n        couponRestrictionsCategories.length == 0 &&\r\n        (limitCategories == \"SI\" || ExcludeCategories == \"SI\")\r\n      ) {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Falta agregar las categorias a las que desea aplicar la restricción.\";\r\n      } else if (date_a >= date_b) {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"La fecha inicial no debe ser mayor o igual a la de expiración.\";\r\n      } else {\r\n        let reorder1 = [];\r\n        let reorder2 = [];\r\n        let reorder3 = [];\r\n\r\n        for (var i = 0; i < couponRestrictionsCustomers.length; i++) {\r\n          reorder1.push(couponRestrictionsCustomers[i].name);\r\n        }\r\n\r\n        for (var k = 0; k < couponRestrictionsProducts.length; k++) {\r\n          reorder2.push(couponRestrictionsProducts[k].name);\r\n        }\r\n\r\n        for (var m = 0; m < couponRestrictionsCategories.length; m++) {\r\n          reorder3.push(couponRestrictionsCategories[m].name);\r\n        }\r\n\r\n        let id = this.data.id\r\n        exclusivo == true ? exclusivo = 'SI': exclusivo = 'NO'\r\n        let data = {\r\n          id: id,\r\n          name: name,\r\n          descrp: descrp,\r\n          code: code,\r\n          cstatus: cstatus,\r\n          date_a: date_a,\r\n          date_b: date_b,\r\n          freeShipping: freeShipping,\r\n          totalAvailable: totalAvailable,\r\n          totalAvailableCustomer: totalAvailableCustomer,\r\n          minAmount: minAmount,\r\n          maxAmount: maxAmount,\r\n          type: type,\r\n          value: value,\r\n          limitCustomers: limitCustomers,\r\n          ExcludeCustomers: ExcludeCustomers,\r\n          limitCategories: limitCategories,\r\n          ExcludeCategories: ExcludeCategories,\r\n          limitProducts: limitProducts,\r\n          ExcludeProducts: ExcludeProducts,\r\n          couponRestrictionsCustomers: reorder1,\r\n          couponRestrictionsProducts: reorder2,\r\n          couponRestrictionsCategories: reorder3,\r\n          exclusivo\r\n        };\r\n\r\n        this.status = \"\";\r\n        this.msg = \"\";\r\n\r\n        let result = await this.$store.dispatch(\"main/editItem\", {\r\n          option: \"cupon\",\r\n          item: data,\r\n        });\r\n\r\n        if (result.status == \"error\") {\r\n          this.status = \"error\";\r\n          this.msg = result.message;\r\n        } else {\r\n          // success\r\n\r\n          this.showModal();\r\n        }\r\n      }\r\n    },\r\n  \r\n\r\n\r\n\r\n \r\n  \r\n    showModal: function () {\r\n      this.viewModal = true;\r\n    },\r\n   \r\n    eliminarItem: async function (id, option) {\r\n      let result = await this.$store.dispatch(\"main/deleteItem\", {\r\n        option: option,\r\n        id: id,\r\n      });\r\n\r\n      if (result.status == \"error\") {\r\n        this.msg = result.message;\r\n        this.status = \"error\";\r\n      } else {\r\n        this.msg = result.message;\r\n        this.status = \"success\";\r\n      }\r\n    },\r\n    back: function () {\r\n      setTimeout(() => this.$router.go(), 200);\r\n    },\r\n \r\n\r\n    codeCreate() {\r\n      let cupones = this.cupones;\r\n      this.code = \"\";\r\n\r\n      var ctrs = \"ABCDEFGHJKLMNOPQRTUVWXYZ123456789\";\r\n      var codeGen = \"\";\r\n\r\n      let valido = false;\r\n      while (valido == false) {\r\n        for (var k = 0; k < 20; k++) {\r\n          codeGen += ctrs.charAt(Math.floor(Math.random() * ctrs.length));\r\n        }\r\n\r\n        let encontrado = \"no\";\r\n        for (var i = 0; i < cupones.length; i++) {\r\n          if (cupones[i].code == codeGen) {\r\n            encontrado = \"si\";\r\n          }\r\n        }\r\n\r\n        if (encontrado == \"si\") {\r\n          codeGen = \"\";\r\n        } else {\r\n          valido = true;\r\n        }\r\n      }\r\n\r\n      this.code = codeGen;\r\n\r\n      return codeGen;\r\n    },\r\n\r\n      changeRCus: function (value) {\r\n        this.resCus = value\r\n        if(value == 'NO'){\r\n            this.data.limitCustomers ='NO'\r\n            this.data.ExcludeCustomers ='NO'\r\n            this.data.couponRestrictionsCustomers = []\r\n        }\r\n\r\n        if(value =='LIMITAR'){\r\n            this.data.limitCustomers ='SI'\r\n            this.data.ExcludeCustomers ='NO'\r\n        }\r\n\r\n        if(value == 'EXCLUIR'){\r\n            this.data.limitCustomers ='NO' \r\n            this.data.ExcludeCustomers ='SI'\r\n        }\r\n\r\n     },\r\n\r\n    añadirCus(email) {\r\n      this.status = \"\";\r\n      this.msg = \"\";\r\n\r\n      if (this.resCus == \"NO\") {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\r\n      } else if (email == undefined || email == \"\") {\r\n        this.status = \"error\";\r\n        this.msg = \"Agrege un email valido.\";\r\n      } else {\r\n        let items = [];\r\n        let res = this.couponRestrictionsCustomers;\r\n\r\n        for (var i = 0; i < res.length; i++) {\r\n          let model = {\r\n            id: res[i].id,\r\n            name: res[i].name,\r\n          };\r\n\r\n          items.push(model);\r\n        }\r\n\r\n        let encontrado = \"NO\";\r\n\r\n        for (var k = 0; k < items.length; k++) {\r\n          if (items[k].name == email) {\r\n            encontrado = \"SI\";\r\n          }\r\n        }\r\n\r\n        if (encontrado == \"NO\") {\r\n          items.push({ id: null, name: email });\r\n        } else {\r\n          this.status = \"error\";\r\n          this.msg = \"Email ya agregado.\";\r\n        }\r\n\r\n        this.couponRestrictionsCustomers = items;\r\n        this.cus_email = \"\";\r\n      }\r\n    },\r\n\r\n    delRcus(key) {\r\n      let items = [];\r\n      let res = this.couponRestrictionsCustomers;\r\n\r\n      for (var i = 0; i < res.length; i++) {\r\n        if (i != key) {\r\n          let model = {\r\n            id: res[i].id,\r\n            name: res[i].name,\r\n          };\r\n          items.push(model);\r\n        } else {\r\n          if (res[i].id != null && res[i].id != undefined) {\r\n            this.eliminarItem(res[i].id, \"rcustomer\");\r\n          }\r\n        }\r\n      }\r\n\r\n      this.couponRestrictionsCustomers = items;\r\n    },\r\n\r\n  \r\n\r\n     changeRCat: function (value) {\r\n        this.resCat = value\r\n        if(value == 'NO'){\r\n            this.data.limitCategories ='NO'\r\n            this.data.ExcludeCategories ='NO'\r\n            this.data.couponRestrictionsCategories = []\r\n        }\r\n\r\n        if(value =='LIMITAR'){\r\n            this.data.limitCategories ='SI'\r\n            this.data.ExcludeCategories ='NO'\r\n        }\r\n\r\n        if(value == 'EXCLUIR'){\r\n            this.data.limitCategories  ='NO' \r\n            this.data.ExcludeCategories ='SI'\r\n        }\r\n\r\n     },\r\n\r\n    añadirCat(categoria) {\r\n      this.status = \"\";\r\n      this.msg = \"\";\r\n\r\n      if (this.resCat == \"NO\") {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\r\n      } else if (categoria == undefined || categoria == \"\") {\r\n        this.status = \"error\";\r\n        this.msg = \"Agrege una categoría valida.\";\r\n      } else {\r\n        let cate = this.categorias;\r\n        let isvalid = \"NO\";\r\n        for (var i = 0; i < cate.length; i++) {\r\n          if (cate[i].name == categoria) {\r\n            isvalid = \"SI\";\r\n          }\r\n        }\r\n\r\n        if (isvalid == \"SI\") {\r\n          let items = [];\r\n          let res = this.couponRestrictionsCategories;\r\n\r\n          for (var i = 0; i < res.length; i++) {\r\n            let model = {\r\n              id: res[i].id,\r\n              name: res[i].name,\r\n            };\r\n\r\n            items.push(model);\r\n          }\r\n\r\n          let encontrado = \"NO\";\r\n\r\n          for (var k = 0; k < items.length; k++) {\r\n            if (items[k].name == categoria) {\r\n              encontrado = \"SI\";\r\n            }\r\n          }\r\n\r\n          if (encontrado == \"NO\") {\r\n            items.push({ id: null, name: categoria });\r\n          } else {\r\n            this.status = \"error\";\r\n            this.msg = \"Categoría ya agregada.\";\r\n          }\r\n\r\n          this.couponRestrictionsCategories = items;\r\n          //this.cat_name = \"\";\r\n        } else {\r\n          this.status = \"error\";\r\n          this.msg = \"Categoría no encontrada.\";\r\n          //this.cat_name = \"\";\r\n        }\r\n      }\r\n    },\r\n\r\n    delRcat(key) {\r\n      let items = [];\r\n      let res = this.couponRestrictionsCategories;\r\n\r\n      for (var i = 0; i < res.length; i++) {\r\n        if (i != key) {\r\n          let model = {\r\n            id: res[i].id,\r\n            name: res[i].name,\r\n          };\r\n          items.push(model);\r\n        } else {\r\n          if (res[i].id != null && res[i].id != undefined) {\r\n            this.eliminarItem(res[i].id, \"rcategory\");\r\n          }\r\n        }\r\n      }\r\n\r\n      this.couponRestrictionsCategories = items;\r\n    },\r\n\r\n        changeRProd: function (value) {\r\n        this.resProd = value\r\n        if(value == 'NO'){\r\n            this.data.limitProducts ='NO'\r\n            this.data.ExcludeProducts ='NO'\r\n            this.couponRestrictionsProducts = []\r\n        }\r\n\r\n        if(value =='LIMITAR'){\r\n            this.data.limitProducts ='SI'\r\n            this.data.ExcludeProducts ='NO'\r\n        }\r\n\r\n        if(value == 'EXCLUIR'){\r\n            this.data.limitProducts  ='NO' \r\n            this.data.ExcludeProducts ='SI'\r\n        }\r\n\r\n     },\r\n\r\n    añadirProd(producto) {\r\n      this.status = \"\";\r\n      this.msg = \"\";\r\n\r\n      if (this.resProd == \"NO\") {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\r\n      } else if (producto == undefined || producto == \"\") {\r\n        this.status = \"error\";\r\n        this.msg = \"Agrege una categoría valida.\";\r\n      } else {\r\n        let prods = this.products;\r\n        let isvalid = \"NO\";\r\n        for (var i = 0; i < prods.length; i++) {\r\n          if (prods[i].name == producto) {\r\n            isvalid = \"SI\";\r\n          }\r\n        }\r\n\r\n        if (isvalid == \"SI\") {\r\n          let items = [];\r\n          let res = this.couponRestrictionsProducts;\r\n\r\n          for (var i = 0; i < res.length; i++) {\r\n            let model = {\r\n              id: res[i].id,\r\n              name: res[i].name,\r\n            };\r\n\r\n            items.push(model);\r\n          }\r\n\r\n          let encontrado = \"NO\";\r\n\r\n          for (var k = 0; k < items.length; k++) {\r\n            if (items[k].name == producto) {\r\n              encontrado = \"SI\";\r\n            }\r\n          }\r\n\r\n          if (encontrado == \"NO\") {\r\n            items.push({ id: null, name: producto });\r\n          } else {\r\n            this.status = \"error\";\r\n            this.msg = \"Producto ya agregado.\";\r\n          }\r\n\r\n          this.couponRestrictionsProducts = items;\r\n          this.prod_name = \"\";\r\n        } else {\r\n          this.status = \"error\";\r\n          this.msg = \"Producto no encontrado.\";\r\n          this.prod_name = \"\";\r\n        }\r\n      }\r\n    },\r\n\r\n    delRprod(key) {\r\n      let items = [];\r\n      let res = this.couponRestrictionsProducts;\r\n\r\n      for (var i = 0; i < res.length; i++) {\r\n        if (i != key) {\r\n          let model = {\r\n            id: res[i].id,\r\n            name: res[i].name,\r\n          };\r\n          items.push(model);\r\n        } else {\r\n          if (res[i].id != null && res[i].id != undefined) {\r\n            this.eliminarItem(res[i].id, \"rproduct\");\r\n          }\r\n        }\r\n      }\r\n\r\n      this.couponRestrictionsProducts = items;\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.gencode {\r\n  color: var(--color-1);\r\n  font-weight: 700;\r\n  font-size: 0.7291666666666666vw;\r\n  cursor: pointer;\r\n}\r\n.grup-form {\r\n  align-items: flex-start;\r\n}\r\n#AddCat label {\r\n  color: var(--color-2);\r\n  font-weight: 700;\r\n  font-size: 0.7291666666666666vw;\r\n  margin-bottom: 0.3vw;\r\n}\r\n\r\n#AddCat input,\r\n#AddCat select {\r\n  height: 2.5vw;\r\n  width: 14.716666666666668vw;\r\n  border: 0.052083vw solid var(--color-2);\r\n  border-radius: 0vw 1.5vw 1.5vw 0vw;\r\n  color: var(--color-4);\r\n  font-size: 0.7291666666666666vw;\r\n  font-weight: 500;\r\n  padding-left: 1.09375vw;\r\n}\r\n\r\n#select-role {\r\n  height: 2.5vw;\r\n  width: 13.716667vw;\r\n  border: 0.052083vw solid var(--color-2);\r\n  border-radius: 0vw 1.5vw 1.5vw 0vw;\r\n  color: var(--color-4);\r\n  font-size: 0.7291666666666666vw;\r\n  font-weight: 500;\r\n  padding-left: 1.09375vw;\r\n  display: flex;\r\n  align-items: center;\r\n  background-image: url(\"../../assets/blueflecha.svg\");\r\n  background-repeat: no-repeat;\r\n  background-position-y: center;\r\n  background-position-x: 12.6vw;\r\n}\r\n#select-role.rounded {\r\n  border-radius: 0vw 1.5vw 0vw 0vw;\r\n  border-left: 0.052083vw solid var(--color-2);\r\n  border-right: 0.052083vw solid var(--color-2);\r\n  border-top: 0.052083vw solid var(--color-2);\r\n  border-bottom: 0;\r\n}\r\n#select-ch:checked ~ .options-cont {\r\n  display: flex;\r\n  position: absolute;\r\n  padding: 0.573vw 1.25vw;\r\n  flex-direction: column;\r\n  background-color: white;\r\n  width: 12.3vw;\r\n  border-left: 0.052083vw solid var(--color-2);\r\n  border-right: 0.052083vw solid var(--color-2);\r\n  border-top: 0;\r\n  border-bottom: 0.052083vw solid var(--color-2);\r\n}\r\n\r\n.bodytbl-items {\r\n  width: 15vw;\r\n}\r\n\r\np.prest{\r\n  font-size: 1vw;\r\n  color: var(--color-1);\r\n  font-weight: 800;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}