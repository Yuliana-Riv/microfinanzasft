{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapActions } from \"vuex\";\nexport default {\n  name: \"AddCupon\",\n  data() {\n    return {\n      optionsAct: false,\n      optionsAct2: false,\n      optionsAct3: false,\n      optionsAct4: false,\n      optionsAct5: false,\n      optionsAct6: false,\n      viewModal: false,\n      name: \"\",\n      descrp: \"\",\n      code: \"\",\n      exclusivo: false,\n      cstatus: \"INACTIVO\",\n      date_a: \"\",\n      date_b: \"\",\n      freeShipping: \"NO\",\n      totalAvailable: 0,\n      totalAvailableCustomer: 1,\n      minAmount: 0,\n      maxAmount: 0,\n      type: \"PORCENTAJE\",\n      value: 0,\n      resCus: \"NO\",\n      resProd: \"NO\",\n      resCat: \"NO\",\n      limitCustomers: \"NO\",\n      ExcludeCustomers: \"NO\",\n      limitCategories: \"NO\",\n      ExcludeCategories: \"NO\",\n      limitProducts: \"NO\",\n      ExcludeProducts: \"NO\",\n      couponRestrictionsCustomers: [],\n      couponRestrictionsProducts: [],\n      couponRestrictionsCategories: [],\n      cus_email: \"\",\n      cat_name: \"\",\n      prod_name: \"\",\n      status: \"\",\n      msg: \"\",\n      added: \"\",\n      currentPage: 1,\n      itemsPerPage: 4,\n      currentPage2: 1,\n      itemsPerPage2: 4\n    };\n  },\n  async beforeMount() {\n    let token = await this.$store.dispatch(\"admin/getToken\");\n    this.$store.dispatch(\"admin/decode\", token);\n  },\n  created() {\n    this.getAllInfoCat(\"category\");\n    this.getAllInfoPro(\"product\");\n    this.getCupons(\"cupones\");\n  },\n  computed: {\n    cupones() {\n      return this.$store.getters[\"shopcar/data\"];\n    },\n    products() {\n      return this.$store.getters[\"product/data\"];\n    },\n    categorias() {\n      let allctg = this.$store.getters[\"category/data\"];\n      let result = [];\n      if (allctg != 'No se encontraron coincidencias' && allctg != 'error') {\n        for (var i = 0; i < allctg.length; i++) {\n          if (allctg[i].id != 1) {\n            result.push(allctg[i]);\n          }\n        }\n      }\n      return result;\n    },\n    url() {\n      return this.$store.getters[\"main/baseURL\"];\n    },\n    user() {\n      return this.$store.getters[\"admin/getIdentity\"];\n    },\n    //Paginacion productos\n\n    allItems() {\n      return Object.keys(this.products).map(pid => this.products[pid]);\n    },\n    filteredItems() {\n      return this.allItems.slice((this.currentPage - 1) * this.itemsPerPage, this.currentPage * this.itemsPerPage);\n    },\n    totalPages() {\n      let total = Math.ceil(this.allItems.length / this.itemsPerPage);\n      if (total < this.currentPage) {\n        this.currentPage = 1;\n      }\n      return total;\n    },\n    allItems2() {\n      return Object.keys(this.categorias).map(pid => this.categorias[pid]);\n    },\n    filteredItems2() {\n      return this.allItems2.slice((this.currentPage2 - 1) * this.itemsPerPage2, this.currentPage2 * this.itemsPerPage2);\n    },\n    totalPages2() {\n      let total = Math.ceil(this.allItems2.length / this.itemsPerPage2);\n      if (total < this.currentPage2) {\n        this.currentPage2 = 1;\n      }\n      return total;\n    }\n  },\n  methods: {\n    ...mapActions(\"shopcar\", [\"getAllInfoCar\"]),\n    ...mapActions(\"main\", [\"getAllInfo\"]),\n    ...mapActions(\"product\", [\"getAllInfoPro\"]),\n    ...mapActions(\"shopcar\", [\"setAddedCar\"]),\n    ...mapActions(\"shopcar\", [\"setHistoryOptionCar\"]),\n    ...mapActions(\"category\", [\"getAllInfoCat\"]),\n    wait: function () {\n      setTimeout(() => this.$router.go(), 200);\n    },\n    submit: async function (name, descrp, code, cstatus, date_a, date_b, freeShipping, totalAvailable, totalAvailableCustomer, minAmount, maxAmount, type, value, limitCustomers, ExcludeCustomers, limitCategories, ExcludeCategories, limitProducts, ExcludeProducts, couponRestrictionsCustomers, couponRestrictionsProducts, couponRestrictionsCategories, exclusivo) {\n      if (couponRestrictionsCustomers.length == 0 && (limitCustomers == \"SI\" || ExcludeCustomers == \"SI\")) {\n        this.status = \"error\";\n        this.msg = \"Falta agregar los clientes a los que desea aplicar la restricción.\";\n      } else if (couponRestrictionsProducts.length == 0 && (limitProducts == \"SI\" || ExcludeProducts == \"SI\")) {\n        this.status = \"error\";\n        this.msg = \"Falta agregar los productos a los que desea aplicar la restricción.\";\n      } else if (couponRestrictionsCategories.length == 0 && (limitCategories == \"SI\" || ExcludeCategories == \"SI\")) {\n        this.status = \"error\";\n        this.msg = \"Falta agregar las categorias a las que desea aplicar la restricción.\";\n      } else if (date_a >= date_b) {\n        this.status = \"error\";\n        this.msg = \"La fecha inicial no debe ser mayor o igual a la de expiración.\";\n      } else {\n        exclusivo == true ? exclusivo = 'SI' : exclusivo = 'NO';\n        let data = {\n          name: name,\n          descrp: descrp,\n          code: code,\n          cstatus: cstatus,\n          date_a: date_a,\n          date_b: date_b,\n          freeShipping: freeShipping,\n          totalAvailable: totalAvailable,\n          totalAvailableCustomer: totalAvailableCustomer,\n          minAmount: minAmount,\n          maxAmount: maxAmount,\n          type: type,\n          value: value,\n          limitCustomers: limitCustomers,\n          ExcludeCustomers: ExcludeCustomers,\n          limitCategories: limitCategories,\n          ExcludeCategories: ExcludeCategories,\n          limitProducts: limitProducts,\n          ExcludeProducts: ExcludeProducts,\n          couponRestrictionsCustomers: couponRestrictionsCustomers,\n          couponRestrictionsProducts: couponRestrictionsProducts,\n          couponRestrictionsCategories: couponRestrictionsCategories,\n          exclusivo\n        };\n        this.status = \"\";\n        this.msg = \"\";\n        let result = await this.$store.dispatch(\"main/addItem\", {\n          option: \"cupon\",\n          item: data\n        });\n        if (result.status == \"error\") {\n          this.status = \"error\";\n          this.msg = result.message;\n        } else {\n          // success\n\n          this.added = result.added;\n          this.setAddedCar(result.added);\n          this.showModal();\n        }\n      }\n    },\n    closeSelect() {\n      this.active = false;\n      document.getElementById(\"select-ch\").checked = false;\n    },\n    includesItem(search, name) {\n      if (search == \"\") {\n        return true;\n      }\n      name = name.toLowerCase();\n      search = search.toLowerCase();\n      if (search == \"\") {\n        return false;\n      }\n      return name.includes(search);\n    },\n    includesItem2(search, name) {\n      if (search == \"\") {\n        return true;\n      }\n      name = name.toLowerCase();\n      search = search.toLowerCase();\n      if (search == \"\") {\n        return false;\n      }\n      return name.includes(search);\n    },\n    day() {\n      return dayjs().format(\"YYYY-MM-DD\");\n    },\n    minday() {\n      return dayjs().add(1, \"days\").format(\"YYYY-MM-DD\");\n    },\n    showModal: function () {\n      this.viewModal = true;\n    },\n    closeModal: function () {\n      this.viewModal = false;\n      this.setAddedCar(\"\");\n      this.setHistoryOptionCar(\"Default\");\n    },\n    Add: function () {\n      this.status = \"\";\n      this.message = \"\";\n      this.name = \"\";\n      this.parent_name = \"\", this.id_parent = 1;\n      this.viewModal = false;\n      this.setAddedCar(\"\");\n    },\n    toEdit: function () {\n      this.setHistoryOptionCar(\"EditCou\");\n      this.viewModal = false;\n    },\n    back: function () {\n      setTimeout(() => this.$router.go(), 200);\n    },\n    previewFiles(e) {\n      var files = e.target.files || e.dataTransfer.files;\n      if (!files.length) return;\n      this.file1 = files[0];\n      this.archivo = this.file1.name;\n    },\n    codeCreate() {\n      let cupones = this.cupones;\n      this.code = \"\";\n      var ctrs = \"ABCDEFGHJKLMNOPQRTUVWXYZ123456789\";\n      var codeGen = \"\";\n      let valido = false;\n      while (valido == false) {\n        for (var k = 0; k < 20; k++) {\n          codeGen += ctrs.charAt(Math.floor(Math.random() * ctrs.length));\n        }\n        let encontrado = \"no\";\n        for (var i = 0; i < cupones.length; i++) {\n          if (cupones[i].code == codeGen) {\n            encontrado = \"si\";\n          }\n        }\n        if (encontrado == \"si\") {\n          codeGen = \"\";\n        } else {\n          valido = true;\n        }\n      }\n      this.code = codeGen;\n      return codeGen;\n    },\n    changeRCus: function (value) {\n      this.resCus = value;\n      if (value == \"NO\") {\n        this.limitCustomers = \"NO\";\n        this.ExcludeCustomers = \"NO\";\n        this.couponRestrictionsCustomers = [];\n      }\n      if (value == \"LIMITAR\") {\n        this.limitCustomers = \"SI\";\n        this.ExcludeCustomers = \"NO\";\n      }\n      if (value == \"EXCLUIR\") {\n        this.limitCustomers = \"NO\";\n        this.ExcludeCustomers = \"SI\";\n      }\n    },\n    añadirCus(email) {\n      this.status = \"\";\n      this.msg = \"\";\n      if (this.resCus == \"NO\") {\n        this.status = \"error\";\n        this.msg = \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\n      } else if (email == undefined || email == \"\") {\n        this.status = \"error\";\n        this.msg = \"Agrege un email valido.\";\n      } else {\n        let items = [];\n        let res = this.couponRestrictionsCustomers;\n        for (var i = 0; i < res.length; i++) {\n          items.push(res[i]);\n        }\n        let encontrado = \"NO\";\n        for (var k = 0; k < items.length; k++) {\n          if (items[k] == email) {\n            encontrado = \"SI\";\n          }\n        }\n        if (encontrado == \"NO\") {\n          items.push(email);\n        } else {\n          this.status = \"error\";\n          this.msg = \"Email ya agregado.\";\n        }\n        this.couponRestrictionsCustomers = items;\n        this.cus_email = \"\";\n      }\n    },\n    delRcus(key) {\n      let items = [];\n      let res = this.couponRestrictionsCustomers;\n      for (var i = 0; i < res.length; i++) {\n        if (i != key) {\n          items.push(res[i]);\n        }\n      }\n      this.couponRestrictionsCustomers = items;\n    },\n    /*\r\n      limitCustomers:\"NO\",  \r\n        ExcludeCustomers:\"NO\", \r\n        limitCategories:\"NO\",  \r\n        ExcludeCategories:\"NO\", \r\n        limitProducts:\"NO\", \r\n        ExcludeProducts:\"NO\", \r\n        */\n\n    changeRCat: function (value) {\n      this.resCat = value;\n      if (value == \"NO\") {\n        this.limitCategories = \"NO\";\n        this.ExcludeCategories = \"NO\";\n        this.couponRestrictionsCategories = [];\n      }\n      if (value == \"LIMITAR\") {\n        this.limitCategories = \"SI\";\n        this.ExcludeCategories = \"NO\";\n      }\n      if (value == \"EXCLUIR\") {\n        this.limitCategories = \"NO\";\n        this.ExcludeCategories = \"SI\";\n      }\n    },\n    añadirCat(categoria) {\n      this.status = \"\";\n      this.msg = \"\";\n      if (this.resCat == \"NO\") {\n        this.status = \"error\";\n        this.msg = \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\n      } else if (categoria == undefined || categoria == \"\") {\n        this.status = \"error\";\n        this.msg = \"Agrege una categoría valida.\";\n      } else {\n        let cate = this.categorias;\n        let isvalid = \"NO\";\n        for (var i = 0; i < cate.length; i++) {\n          if (cate[i].name == categoria) {\n            isvalid = \"SI\";\n          }\n        }\n        if (isvalid == \"SI\") {\n          let items = [];\n          let res = this.couponRestrictionsCategories;\n          for (var i = 0; i < res.length; i++) {\n            items.push(res[i]);\n          }\n          let encontrado = \"NO\";\n          for (var k = 0; k < items.length; k++) {\n            if (items[k] == categoria) {\n              encontrado = \"SI\";\n            }\n          }\n          if (encontrado == \"NO\") {\n            items.push(categoria);\n          } else {\n            this.status = \"error\";\n            this.msg = \"Categoría ya agregada.\";\n          }\n          this.couponRestrictionsCategories = items;\n          //this.cat_name = \"\";\n        } else {\n          this.status = \"error\";\n          this.msg = \"Categoría no encontrada.\";\n          //this.cat_name = \"\";\n        }\n      }\n    },\n\n    delRcat(key) {\n      let items = [];\n      let res = this.couponRestrictionsCategories;\n      for (var i = 0; i < res.length; i++) {\n        if (i != key) {\n          items.push(res[i]);\n        }\n      }\n      this.couponRestrictionsCategories = items;\n    },\n    changeRProd: function (value) {\n      this.resProd = value;\n      if (value == \"NO\") {\n        this.limitProducts = \"NO\";\n        this.ExcludeProducts = \"NO\";\n        this.couponRestrictionsProducts = [];\n      }\n      if (value == \"LIMITAR\") {\n        this.limitProducts = \"SI\";\n        this.ExcludeProducts = \"NO\";\n      }\n      if (value == \"EXCLUIR\") {\n        this.limitProducts = \"NO\";\n        this.ExcludeProducts = \"SI\";\n      }\n    },\n    añadirProd(producto) {\n      this.status = \"\";\n      this.msg = \"\";\n      if (this.resProd == \"NO\") {\n        this.status = \"error\";\n        this.msg = \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\n      } else if (producto == undefined || producto == \"\") {\n        this.status = \"error\";\n        this.msg = \"Agrege una categoría valida.\";\n      } else {\n        let prods = this.products;\n        let isvalid = \"NO\";\n        for (var i = 0; i < prods.length; i++) {\n          if (prods[i].name == producto) {\n            isvalid = \"SI\";\n          }\n        }\n        if (isvalid == \"SI\") {\n          let items = [];\n          let res = this.couponRestrictionsProducts;\n          for (var i = 0; i < res.length; i++) {\n            items.push(res[i]);\n          }\n          let encontrado = \"NO\";\n          for (var k = 0; k < items.length; k++) {\n            if (items[k] == producto) {\n              encontrado = \"SI\";\n            }\n          }\n          if (encontrado == \"NO\") {\n            items.push(producto);\n          } else {\n            this.status = \"error\";\n            this.msg = \"Producto ya agregado.\";\n          }\n          this.couponRestrictionsProducts = items;\n          this.prod_name = \"\";\n        } else {\n          this.status = \"error\";\n          this.msg = \"Producto no encontrado.\";\n          this.prod_name = \"\";\n        }\n      }\n    },\n    delRprod(key) {\n      let items = [];\n      let res = this.couponRestrictionsProducts;\n      for (var i = 0; i < res.length; i++) {\n        if (i != key) {\n          items.push(res[i]);\n        }\n      }\n      this.couponRestrictionsProducts = items;\n    }\n  }\n};","map":{"version":3,"mappings":";AAwhBA;AACA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAR;MACAS;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACA;IACA;IACA;EACA;EACAC;IACA;IACA;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MAEA;QACA;UACA;YACAC;UACA;QAEA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IAEA;;IAEAC;MACA;IACA;IACAC;MACA,2BACA,4CACA,qCACA;IACA;IACAC;MACA;MACA;QACA;MACA;MACA;IACA;IAEAC;MACA;IACA;IACAC;MACA,4BACA,8CACA,uCACA;IACA;IACAC;MACA;MACA;QACA;MACA;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;IACA;IACA;IACA;IAEAC;MACAC;IACA;IACAC,wBACA7D,MACAS,QACAC,MACAE,SACAC,QACAC,QACAC,cACAC,gBACAC,wBACAC,WACAC,WACAC,MACAC,OACAI,gBACAC,kBACAC,iBACAC,mBACAC,eACAC,iBACAC,6BACAC,4BACAC,8BACAtB,WACA;MACA,IACAoB,4CACAN,qDACA;QACA;QACA,WACA;MACA,WACAO,2CACAH,mDACA;QACA;QACA,WACA;MACA,WACAI,6CACAN,uDACA;QACA;QACA,WACA;MACA;QACA;QACA,WACA;MACA;QACAhB;QAEA;UACAX;UACAS;UACAC;UACAE;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAI;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAtB;QACA;QAEA;QACA;QAEA;UACAmD;UACAC;QACA;QAEA;UACA;UACA;QACA;UACA;;UAEA;UACA;UACA;QACA;MACA;IACA;IACAC;MACA;MACAC;IACA;IAEAC;MACA;QACA;MACA;MACAlE;MACAmE;MACA;QACA;MACA;MACA;IACA;IAEAC;MACA;QACA;MACA;MACApE;MACAmE;MACA;QACA;MACA;MACA;IACA;IAEAE;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MAEA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACAf;IACA;IACAgB;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;MACA;MACA;QACA;UACAC;QACA;QACA;QACA;UACA;YACAC;UACA;QACA;QACA;UACAD;QACA;UACAE;QACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;QACA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;IACA;IAEAC;MACA;MACA;MAEA;QACA;QACA,WACA;MACA;QACA;QACA;MACA;QACA;QACA;QAEA;UACAC;QACA;QAEA;QAEA;UACA;YACAJ;UACA;QACA;QAEA;UACAI;QACA;UACA;UACA;QACA;QAEA;QACA;MACA;IACA;IAEAC;MACA;MACA;MAEA;QACA;UACAD;QACA;MACA;MAEA;IACA;IAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEAE;MACA;MACA;QACA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;IACA;IAEAC;MACA;MACA;MAEA;QACA;QACA,WACA;MACA;QACA;QACA;MACA;QACA;QACA;QACA;UACA;YACAC;UACA;QACA;QAEA;UACA;UACA;UAEA;YACAJ;UACA;UAEA;UAEA;YACA;cACAJ;YACA;UACA;UAEA;YACAI;UACA;YACA;YACA;UACA;UAEA;UACA;QACA;UACA;UACA;UACA;QACA;MACA;IACA;;IAEAK;MACA;MACA;MAEA;QACA;UACAL;QACA;MACA;MAEA;IACA;IAEAM;MACA;MACA;QACA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;MAEA;QACA;QACA;MACA;IACA;IAEAC;MACA;MACA;MAEA;QACA;QACA,WACA;MACA;QACA;QACA;MACA;QACA;QACA;QACA;UACA;YACAH;UACA;QACA;QAEA;UACA;UACA;UAEA;YACAJ;UACA;UAEA;UAEA;YACA;cACAJ;YACA;UACA;UAEA;YACAI;UACA;YACA;YACA;UACA;UAEA;UACA;QACA;UACA;UACA;UACA;QACA;MACA;IACA;IAEAQ;MACA;MACA;MAEA;QACA;UACAR;QACA;MACA;MAEA;IACA;EACA;AACA","names":["name","data","optionsAct","optionsAct2","optionsAct3","optionsAct4","optionsAct5","optionsAct6","viewModal","descrp","code","exclusivo","cstatus","date_a","date_b","freeShipping","totalAvailable","totalAvailableCustomer","minAmount","maxAmount","type","value","resCus","resProd","resCat","limitCustomers","ExcludeCustomers","limitCategories","ExcludeCategories","limitProducts","ExcludeProducts","couponRestrictionsCustomers","couponRestrictionsProducts","couponRestrictionsCategories","cus_email","cat_name","prod_name","status","msg","added","currentPage","itemsPerPage","currentPage2","itemsPerPage2","created","computed","cupones","products","categorias","result","url","user","allItems","filteredItems","totalPages","allItems2","filteredItems2","totalPages2","methods","wait","setTimeout","submit","option","item","closeSelect","document","includesItem","search","includesItem2","day","minday","showModal","closeModal","Add","toEdit","back","previewFiles","codeCreate","codeGen","encontrado","valido","changeRCus","añadirCus","items","delRcus","changeRCat","añadirCat","isvalid","delRcat","changeRProd","añadirProd","delRprod"],"sourceRoot":"src/views/shopcar","sources":["AddCupon.vue"],"sourcesContent":["<template >\r\n  <div id=\"AddCat\">\r\n    <div class=\"form-content\">\r\n      <form\r\n        @submit.prevent=\"\r\n          submit(\r\n            name,\r\n            descrp,\r\n            code,\r\n            cstatus,\r\n            date_a,\r\n            date_b,\r\n            freeShipping,\r\n            totalAvailable,\r\n            totalAvailableCustomer,\r\n            minAmount,\r\n            maxAmount,\r\n            type,\r\n            value,\r\n            limitCustomers,\r\n            ExcludeCustomers,\r\n            limitCategories,\r\n            ExcludeCategories,\r\n            limitProducts,\r\n            ExcludeProducts,\r\n            couponRestrictionsCustomers,\r\n            couponRestrictionsProducts,\r\n            couponRestrictionsCategories,\r\n            exclusivo\r\n          )\r\n        \"\r\n      >\r\n        <div class=\"grup-form dflx\">\r\n          <!--nombre-->\r\n          <div class=\"boxform\">\r\n            <label for=\"name\" class=\"name\">Nombre </label>\r\n            <input\r\n              v-model=\"name\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"name\"\r\n    \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n          <div class=\"boxform\">\r\n             <label for=\"exclusivo\" class=\"exclusivo\">Exclusivo : <span v-if=\"exclusivo\">SI</span> <span v-else>NO</span> </label>\r\n             <input type=\"checkbox\" id=\"exclusivo\"  v-model=\"exclusivo\" >\r\n          </div>\r\n        </div>\r\n\r\n        <!--categoría-->\r\n        <div class=\"grup-form dflx\">\r\n          <div class=\"boxform\">\r\n            <label for=\"url\" class=\"url\">Descripcion </label>\r\n            <textarea\r\n              v-model=\"descrp\"\r\n              id=\"name\"\r\n              name=\"descrp\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              style=\"resize: none\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--codigo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">Codigo </label>\r\n            <input\r\n              v-model=\"code\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"code\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n            <p class=\"gencode\" @click=\"codeCreate()\">GENERAR CÓDIGO &#11119;</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">Fecha </label>\r\n            <input\r\n              v-model=\"date_a\"\r\n              type=\"date\"\r\n              id=\"name\"\r\n              name=\"date_a\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">Fecha Exp. </label>\r\n            <input\r\n              v-model=\"date_b\"\r\n              type=\"date\"\r\n              id=\"name\"\r\n              name=\"date_b\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--estatus-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">Estatus </label>\r\n            <input\r\n              v-model=\"cstatus\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"cstatus\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct }\"\r\n              @click=\"optionsAct = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct }\"\r\n              @click=\"optionsAct = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"cstatus = 'INACTIVO'\">\r\n                INACTIVO\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"cstatus = 'ACTIVO'\">ACTIVO</div>\r\n            </div>\r\n          </div>\r\n          <!--estatus-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">ENVÍO GRATIS </label>\r\n            <input\r\n              v-model=\"freeShipping\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"freeShipping\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct2 }\"\r\n              @click=\"optionsAct2 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct2 }\"\r\n              @click=\"optionsAct2 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"freeShipping = 'SI'\">SI</div>\r\n              <div class=\"option-btn\" @click=\"freeShipping = 'NO'\">NO</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--total-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">TOTAL DISPONIBLE </label>\r\n            <input\r\n              v-model=\"totalAvailable\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"totalAvailable\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n          <!--available total-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">NÚM. USOS POR CLIENTE </label>\r\n            <input\r\n              v-model=\"totalAvailableCustomer\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"totalAvailableCustomer\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">VALOR </label>\r\n            <input\r\n              v-model=\"value\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"totalAvailable\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n          <!--tipo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">ENVÍO GRATIS </label>\r\n            <input\r\n              v-model=\"type\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"freeShipping\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct3 }\"\r\n              @click=\"optionsAct3 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct3 }\"\r\n              @click=\"optionsAct3 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"type = 'IMPORTE'\">IMPORTE</div>\r\n              <div class=\"option-btn\" @click=\"type = 'PORCENTAJE'\">\r\n                PORCENTAJE\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">IMPORTE MÍNIMO</label>\r\n            <input\r\n              v-model=\"minAmount\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"minAmount\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n          <!--fecha-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">IMPORTE MÁXIMO </label>\r\n            <input\r\n              v-model=\"maxAmount\"\r\n              type=\"number\"\r\n              id=\"name\"\r\n              name=\"maxAmount\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <p class=\"prest\">RESTRICCIONES</p>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--tipo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">RESTRICCIÓN CLIENTE </label>\r\n            <input\r\n              v-model=\"resCus\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"resCus\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct4 }\"\r\n              @click=\"optionsAct4 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct4 }\"\r\n              @click=\"optionsAct4 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"changeRCus('LIMITAR')\">\r\n                LIMITAR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRCus('EXCLUIR')\">\r\n                EXCLUIR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRCus('NO')\">NO</div>\r\n            </div>\r\n            <div class=\"grup-form dflx\" v-if=\"resCus != 'NO'\">\r\n              <div class=\"boxform\">\r\n                <label for=\"code\" class=\"code\">Añadir email</label>\r\n                <input\r\n                  v-model=\"cus_email\"\r\n                  type=\"email\"\r\n                  id=\"cus_email\"\r\n                  name=\"totalAvailableCustomer\"\r\n                  \r\n                  class=\"in1\"\r\n                />\r\n                <p class=\"alta\" @click=\"añadirCus(cus_email)\">AÑADIR</p>\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          couponRestrictionsCustomers != 'No se encontraron coincidencias.' &&\r\n                          couponRestrictionsCustomers != 'error'\r\n                        \"\r\n                      >\r\n                        <div v-for=\"(prm, key) in couponRestrictionsCustomers\" :key=\"key\"\r\n                        class=\"dflx sbtw\">\r\n                          <!--<p class=\"itemp cp dflx\">-->\r\n                            <p class=\"item1\">{{key}}</p>\r\n                            <p  class=\"item2\">{{prm}}</p>\r\n                            <p class=\"item3 pointer\" @click=\"delRcus(key)\">X</p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!--tipo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">RESTRICCIÓN CATEGORÍA </label>\r\n            <input\r\n              v-model=\"resCat\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"resCat\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct5 }\"\r\n              @click=\"optionsAct5 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct5 }\"\r\n              @click=\"optionsAct5 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"changeRCat('LIMITAR')\">\r\n                LIMITAR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRCat('EXCLUIR')\">\r\n                EXCLUIR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRCat('NO')\">NO</div>\r\n            </div>\r\n            <div class=\"grup-form dflx\" v-if=\"resCat != 'NO'\">\r\n              <!--categoría-->\r\n              <div class=\"boxform\">\r\n                <label for=\"role\" class=\"role\">Añadir categoría</label>\r\n\r\n                <!--<input\r\n              v-model=\"cat_name\"\r\n              type=\"text\"\r\n              id=\"tipos\"\r\n              name=\"tipos\"\r\n              disabled\r\n              required\r\n            />-->\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          categorias != 'No se encontraron coincidencias.' &&\r\n                          categorias != 'error'\r\n                        \"\r\n                      >\r\n                        <div v-for=\"(prm, key) in categorias\" :key=\"key\">\r\n                          <p class=\"itemp cp\" @click=\"añadirCat(prm.name)\">\r\n                            {{ prm.name }}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          couponRestrictionsCategories != 'No se encontraron coincidencias.' &&\r\n                          couponRestrictionsCategories != 'error'\r\n                          \"\r\n                      >\r\n                        <div v-for=\"(prm, key) in couponRestrictionsCategories\" :key=\"key\"\r\n                        class=\"dflx sbtw\">\r\n                          <!--<p class=\"itemp cp dflx\">-->\r\n                            <p class=\"item1\">{{key}}</p>\r\n                            <p  class=\"item2\">{{prm}}</p>\r\n                            <p class=\"item3 pointer\" @click=\"delRcat(key)\">X</p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!--tipo-->\r\n          <div class=\"boxform\">\r\n            <label for=\"code\" class=\"code\">RESTRICCIÓN PRODUCTO </label>\r\n            <input\r\n              v-model=\"resProd\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"resProd\"\r\n              \r\n              required\r\n              class=\"in1\"\r\n              :class=\"{ rounded: optionsAct6 }\"\r\n              @click=\"optionsAct6 = true\"\r\n            />\r\n            <div\r\n              class=\"options-cont\"\r\n              :class=\"{ 'op-act': optionsAct6 }\"\r\n              @click=\"optionsAct6 = false\"\r\n            >\r\n              <div class=\"option-btn\" @click=\"changeRProd('LIMITAR')\">\r\n                LIMITAR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRProd('EXCLUIR')\">\r\n                EXCLUIR\r\n              </div>\r\n              <div class=\"option-btn\" @click=\"changeRProd('NO')\">NO</div>\r\n            </div>\r\n            <div class=\"grup-form dflx\" v-if=\"resProd != 'NO'\">\r\n              <!--producto-->\r\n              <div class=\"boxform\">\r\n                <label for=\"role\" class=\"role\">Añadir productos</label>\r\n\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          products != 'No se encontraron coincidencias.' &&\r\n                          products != 'error'\r\n                        \"\r\n                      >\r\n                        <div v-for=\"(prm, key) in products\" :key=\"key\">\r\n                          <p class=\"itemp cp\" @click=\"añadirProd(prm.name)\">\r\n                            {{ prm.name }}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div\r\n                        v-if=\"\r\n                          couponRestrictionsProducts != 'No se encontraron coincidencias.' &&\r\n                          couponRestrictionsProducts != 'error'\r\n                        \"\r\n                      >\r\n                        <div v-for=\"(prm, key) in couponRestrictionsProducts\" :key=\"key\"\r\n                        class=\"dflx sbtw\">\r\n                          <!--<p class=\"itemp cp dflx\">-->\r\n                            <p class=\"item1\">{{key}}</p>\r\n                            <p  class=\"item2\">{{prm}}</p>\r\n                            <p class=\"item3 pointer\" @click=\"delRprod(key)\">X</p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!--regresar/guardar-->\r\n        <div class=\"dflx\">\r\n          <p @click=\"wait()\" class=\"btnRegresar\">Regresar</p>\r\n          <button class=\"alta\" type=\"submit\">Guardar</button>\r\n        </div>\r\n\r\n        <div v-if=\"status != ''\" class=\"status_messages\">\r\n          <div v-if=\"status == 'success'\" class=\"msg msg_success\">\r\n            <p>{{ msg }}</p>\r\n          </div>\r\n          <div v-if=\"status == 'error'\" class=\"msg msg_error\">\r\n            <p>{{ msg }}</p>\r\n          </div>\r\n        </div>\r\n      </form>\r\n\r\n      <div v-if=\"viewModal\" class=\"modal_view\">\r\n        <div id=\"modal_add\">\r\n          <div class=\"body dflx\">\r\n            <h3>Cupón agregado con éxito</h3>\r\n            <img src=\"../../assets/add.png\" alt=\"icono alerta\" />\r\n          </div>\r\n\r\n          <div class=\"modal_add_btns dflx\">\r\n            <p @click=\"Add()\" class=\"otro\">Aceptar</p>\r\n            <p @click=\"toEdit()\" class=\"editar\">Editar</p>\r\n            <p @click=\"back()\" class=\"inicio\">Inicio</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapActions } from \"vuex\";\r\nexport default {\r\n  name: \"AddCupon\",\r\n  data() {\r\n    return {\r\n      optionsAct: false,\r\n      optionsAct2: false,\r\n      optionsAct3: false,\r\n      optionsAct4: false,\r\n      optionsAct5: false,\r\n      optionsAct6: false,\r\nviewModal:false,\r\n      name: \"\",\r\n      descrp: \"\",\r\n      code: \"\",\r\n      exclusivo:false,\r\n      cstatus: \"INACTIVO\",\r\n      date_a: \"\",\r\n      date_b: \"\",\r\n      freeShipping: \"NO\",\r\n      totalAvailable: 0,\r\n      totalAvailableCustomer: 1,\r\n      minAmount: 0,\r\n      maxAmount: 0,\r\n      type: \"PORCENTAJE\",\r\n      value: 0,\r\n      resCus: \"NO\",\r\n      resProd: \"NO\",\r\n      resCat: \"NO\",\r\n      limitCustomers: \"NO\",\r\n      ExcludeCustomers: \"NO\",\r\n      limitCategories: \"NO\",\r\n      ExcludeCategories: \"NO\",\r\n      limitProducts: \"NO\",\r\n      ExcludeProducts: \"NO\",\r\n      couponRestrictionsCustomers: [],\r\n      couponRestrictionsProducts: [],\r\n      couponRestrictionsCategories: [],\r\n      cus_email: \"\",\r\n      cat_name: \"\",\r\n      prod_name: \"\",\r\n      status: \"\",\r\n      msg: \"\",\r\n     \r\n      added: \"\",\r\n      currentPage: 1,\r\n      itemsPerPage: 4,\r\n      currentPage2: 1,\r\n      itemsPerPage2: 4,\r\n    };\r\n  },\r\n  async beforeMount() {\r\n    let token = await this.$store.dispatch(\"admin/getToken\");\r\n    this.$store.dispatch(\"admin/decode\", token);\r\n  },\r\n  created() {\r\n    this.getAllInfoCat(\"category\");\r\n    this.getAllInfoPro(\"product\");\r\n    this.getCupons(\"cupones\");\r\n  },\r\n  computed: {\r\n    cupones() {\r\n      return this.$store.getters[\"shopcar/data\"];\r\n    },\r\n    products() {\r\n      return this.$store.getters[\"product/data\"];\r\n    },\r\n    categorias() {\r\n       let allctg = this.$store.getters[\"category/data\"];\r\n      let result = [];\r\n      \r\n        if(allctg != 'No se encontraron coincidencias'  && allctg !='error'){\r\n          for (var i = 0; i < allctg.length; i++) {\r\n          if (allctg[i].id != 1) {\r\n          result.push(allctg[i])\r\n          } \r\n          \r\n          }\r\n        }\r\n      return result;\r\n    },\r\n    url() {\r\n      return this.$store.getters[\"main/baseURL\"];\r\n    },\r\n    user() {\r\n      return this.$store.getters[\"admin/getIdentity\"];\r\n    },\r\n\r\n    //Paginacion productos\r\n\r\n    allItems() {\r\n      return Object.keys(this.products).map((pid) => this.products[pid]);\r\n    },\r\n    filteredItems() {\r\n      return this.allItems.slice(\r\n        (this.currentPage - 1) * this.itemsPerPage,\r\n        this.currentPage * this.itemsPerPage\r\n      );\r\n    },\r\n    totalPages() {\r\n      let total = Math.ceil(this.allItems.length / this.itemsPerPage);\r\n      if (total < this.currentPage) {\r\n        this.currentPage = 1;\r\n      }\r\n      return total;\r\n    },\r\n\r\n    allItems2() {\r\n      return Object.keys(this.categorias).map((pid) => this.categorias[pid]);\r\n    },\r\n    filteredItems2() {\r\n      return this.allItems2.slice(\r\n        (this.currentPage2 - 1) * this.itemsPerPage2,\r\n        this.currentPage2 * this.itemsPerPage2\r\n      );\r\n    },\r\n    totalPages2() {\r\n      let total = Math.ceil(this.allItems2.length / this.itemsPerPage2);\r\n      if (total < this.currentPage2) {\r\n        this.currentPage2 = 1;\r\n      }\r\n      return total;\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapActions(\"shopcar\", [\"getAllInfoCar\"]),\r\n    ...mapActions(\"main\", [\"getAllInfo\"]),\r\n    ...mapActions(\"product\", [\"getAllInfoPro\"]),\r\n    ...mapActions(\"shopcar\", [\"setAddedCar\"]),\r\n    ...mapActions(\"shopcar\", [\"setHistoryOptionCar\"]),\r\n    ...mapActions(\"category\", [\"getAllInfoCat\"]),\r\n    \r\n    wait: function () {\r\n      setTimeout(() => this.$router.go(), 200);\r\n    },\r\n    submit: async function (\r\n      name,\r\n      descrp,\r\n      code,\r\n      cstatus,\r\n      date_a,\r\n      date_b,\r\n      freeShipping,\r\n      totalAvailable,\r\n      totalAvailableCustomer,\r\n      minAmount,\r\n      maxAmount,\r\n      type,\r\n      value,\r\n      limitCustomers,\r\n      ExcludeCustomers,\r\n      limitCategories,\r\n      ExcludeCategories,\r\n      limitProducts,\r\n      ExcludeProducts,\r\n      couponRestrictionsCustomers,\r\n      couponRestrictionsProducts,\r\n      couponRestrictionsCategories,\r\n      exclusivo\r\n    ) {\r\n      if (\r\n        couponRestrictionsCustomers.length == 0 &&\r\n        (limitCustomers == \"SI\" || ExcludeCustomers == \"SI\")\r\n      ) {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Falta agregar los clientes a los que desea aplicar la restricción.\";\r\n      } else if (\r\n        couponRestrictionsProducts.length == 0 &&\r\n        (limitProducts == \"SI\" || ExcludeProducts == \"SI\")\r\n      ) {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Falta agregar los productos a los que desea aplicar la restricción.\";\r\n      } else if (\r\n        couponRestrictionsCategories.length == 0 &&\r\n        (limitCategories == \"SI\" || ExcludeCategories == \"SI\")\r\n      ) {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Falta agregar las categorias a las que desea aplicar la restricción.\";\r\n      } else if (date_a >= date_b) {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"La fecha inicial no debe ser mayor o igual a la de expiración.\";\r\n      } else {\r\n        exclusivo == true ? exclusivo = 'SI': exclusivo = 'NO'\r\n\r\n        let data = {\r\n          name: name,\r\n          descrp: descrp,\r\n          code: code,\r\n          cstatus: cstatus,\r\n          date_a: date_a,\r\n          date_b: date_b,\r\n          freeShipping: freeShipping,\r\n          totalAvailable: totalAvailable,\r\n          totalAvailableCustomer: totalAvailableCustomer,\r\n          minAmount: minAmount,\r\n          maxAmount: maxAmount,\r\n          type: type,\r\n          value: value,\r\n          limitCustomers: limitCustomers,\r\n          ExcludeCustomers: ExcludeCustomers,\r\n          limitCategories: limitCategories,\r\n          ExcludeCategories: ExcludeCategories,\r\n          limitProducts: limitProducts,\r\n          ExcludeProducts: ExcludeProducts,\r\n          couponRestrictionsCustomers: couponRestrictionsCustomers,\r\n          couponRestrictionsProducts: couponRestrictionsProducts,\r\n          couponRestrictionsCategories: couponRestrictionsCategories,\r\n          exclusivo\r\n        };\r\n\r\n        this.status = \"\";\r\n        this.msg = \"\";\r\n\r\n        let result = await this.$store.dispatch(\"main/addItem\", {\r\n          option: \"cupon\",\r\n          item: data,\r\n        });\r\n\r\n        if (result.status == \"error\") {\r\n          this.status = \"error\";\r\n          this.msg = result.message;\r\n        } else {\r\n          // success\r\n\r\n          this.added = result.added;\r\n          this.setAddedCar(result.added)\r\n          this.showModal();\r\n        }\r\n      }\r\n    },\r\n    closeSelect() {\r\n      this.active = false;\r\n      document.getElementById(\"select-ch\").checked = false;\r\n    },\r\n\r\n    includesItem(search, name) {\r\n      if (search == \"\") {\r\n        return true;\r\n      }\r\n      name = name.toLowerCase();\r\n      search = search.toLowerCase();\r\n      if (search == \"\") {\r\n        return false;\r\n      }\r\n      return name.includes(search);\r\n    },\r\n\r\n    includesItem2(search, name) {\r\n      if (search == \"\") {\r\n        return true;\r\n      }\r\n      name = name.toLowerCase();\r\n      search = search.toLowerCase();\r\n      if (search == \"\") {\r\n        return false;\r\n      }\r\n      return name.includes(search);\r\n    },\r\n\r\n    day() {\r\n      return dayjs().format(\"YYYY-MM-DD\");\r\n    },\r\n    minday() {\r\n      return dayjs().add(1, \"days\").format(\"YYYY-MM-DD\");\r\n    },\r\n    showModal: function () {\r\n      this.viewModal = true;\r\n    },\r\n    closeModal: function () {\r\n      this.viewModal = false;\r\n      this.setAddedCar(\"\");\r\n      this.setHistoryOptionCar(\"Default\");\r\n    },\r\n    Add: function () {\r\n      this.status = \"\";\r\n      this.message = \"\";\r\n      this.name = \"\";\r\n      (this.parent_name = \"\"), (this.id_parent = 1);\r\n\r\n      this.viewModal = false;\r\n      this.setAddedCar(\"\");\r\n    },\r\n    toEdit: function () {\r\n      this.setHistoryOptionCar(\"EditCou\");\r\n      this.viewModal = false;\r\n    },\r\n    back: function () {\r\n      setTimeout(() => this.$router.go(), 200);\r\n    },\r\n    previewFiles(e) {\r\n      var files = e.target.files || e.dataTransfer.files;\r\n      if (!files.length) return;\r\n      this.file1 = files[0];\r\n      this.archivo = this.file1.name;\r\n    },\r\n\r\n    codeCreate() {\r\n      let cupones = this.cupones;\r\n      this.code = \"\";\r\n      var ctrs = \"ABCDEFGHJKLMNOPQRTUVWXYZ123456789\";\r\n      var codeGen = \"\";\r\n      let valido = false;\r\n      while (valido == false) {\r\n        for (var k = 0; k < 20; k++) {\r\n          codeGen += ctrs.charAt(Math.floor(Math.random() * ctrs.length));\r\n        }\r\n        let encontrado = \"no\";\r\n        for (var i = 0; i < cupones.length; i++) {\r\n          if (cupones[i].code == codeGen) {\r\n            encontrado = \"si\";\r\n          }\r\n        }\r\n        if (encontrado == \"si\") {\r\n          codeGen = \"\";\r\n        } else {\r\n          valido = true;\r\n        }\r\n      }\r\n      this.code = codeGen;\r\n      return codeGen;\r\n    },\r\n\r\n    changeRCus: function (value) {\r\n      this.resCus = value;\r\n      if (value == \"NO\") {\r\n        this.limitCustomers = \"NO\";\r\n        this.ExcludeCustomers = \"NO\";\r\n        this.couponRestrictionsCustomers = [];\r\n      }\r\n\r\n      if (value == \"LIMITAR\") {\r\n        this.limitCustomers = \"SI\";\r\n        this.ExcludeCustomers = \"NO\";\r\n      }\r\n\r\n      if (value == \"EXCLUIR\") {\r\n        this.limitCustomers = \"NO\";\r\n        this.ExcludeCustomers = \"SI\";\r\n      }\r\n    },\r\n\r\n    añadirCus(email) {\r\n      this.status = \"\";\r\n      this.msg = \"\";\r\n\r\n      if (this.resCus == \"NO\") {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\r\n      } else if (email == undefined || email == \"\") {\r\n        this.status = \"error\";\r\n        this.msg = \"Agrege un email valido.\";\r\n      } else {\r\n        let items = [];\r\n        let res = this.couponRestrictionsCustomers;\r\n\r\n        for (var i = 0; i < res.length; i++) {\r\n          items.push(res[i]);\r\n        }\r\n\r\n        let encontrado = \"NO\";\r\n\r\n        for (var k = 0; k < items.length; k++) {\r\n          if (items[k] == email) {\r\n            encontrado = \"SI\";\r\n          }\r\n        }\r\n\r\n        if (encontrado == \"NO\") {\r\n          items.push(email);\r\n        } else {\r\n          this.status = \"error\";\r\n          this.msg = \"Email ya agregado.\";\r\n        }\r\n\r\n        this.couponRestrictionsCustomers = items;\r\n        this.cus_email = \"\";\r\n      }\r\n    },\r\n\r\n    delRcus(key) {\r\n      let items = [];\r\n      let res = this.couponRestrictionsCustomers;\r\n\r\n      for (var i = 0; i < res.length; i++) {\r\n        if (i != key) {\r\n          items.push(res[i]);\r\n        }\r\n      }\r\n\r\n      this.couponRestrictionsCustomers = items;\r\n    },\r\n\r\n    /*\r\n      limitCustomers:\"NO\",  \r\n        ExcludeCustomers:\"NO\", \r\n        limitCategories:\"NO\",  \r\n        ExcludeCategories:\"NO\", \r\n        limitProducts:\"NO\", \r\n        ExcludeProducts:\"NO\", \r\n        */\r\n\r\n    changeRCat: function (value) {\r\n      this.resCat = value;\r\n      if (value == \"NO\") {\r\n        this.limitCategories = \"NO\";\r\n        this.ExcludeCategories = \"NO\";\r\n        this.couponRestrictionsCategories = [];\r\n      }\r\n\r\n      if (value == \"LIMITAR\") {\r\n        this.limitCategories = \"SI\";\r\n        this.ExcludeCategories = \"NO\";\r\n      }\r\n\r\n      if (value == \"EXCLUIR\") {\r\n        this.limitCategories = \"NO\";\r\n        this.ExcludeCategories = \"SI\";\r\n      }\r\n    },\r\n\r\n    añadirCat(categoria) {\r\n      this.status = \"\";\r\n      this.msg = \"\";\r\n\r\n      if (this.resCat == \"NO\") {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\r\n      } else if (categoria == undefined || categoria == \"\") {\r\n        this.status = \"error\";\r\n        this.msg = \"Agrege una categoría valida.\";\r\n      } else {\r\n        let cate = this.categorias;\r\n        let isvalid = \"NO\";\r\n        for (var i = 0; i < cate.length; i++) {\r\n          if (cate[i].name == categoria) {\r\n            isvalid = \"SI\";\r\n          }\r\n        }\r\n\r\n        if (isvalid == \"SI\") {\r\n          let items = [];\r\n          let res = this.couponRestrictionsCategories;\r\n\r\n          for (var i = 0; i < res.length; i++) {\r\n            items.push(res[i]);\r\n          }\r\n\r\n          let encontrado = \"NO\";\r\n\r\n          for (var k = 0; k < items.length; k++) {\r\n            if (items[k] == categoria) {\r\n              encontrado = \"SI\";\r\n            }\r\n          }\r\n\r\n          if (encontrado == \"NO\") {\r\n            items.push(categoria);\r\n          } else {\r\n            this.status = \"error\";\r\n            this.msg = \"Categoría ya agregada.\";\r\n          }\r\n\r\n          this.couponRestrictionsCategories = items;\r\n          //this.cat_name = \"\";\r\n        } else {\r\n          this.status = \"error\";\r\n          this.msg = \"Categoría no encontrada.\";\r\n          //this.cat_name = \"\";\r\n        }\r\n      }\r\n    },\r\n\r\n    delRcat(key) {\r\n      let items = [];\r\n      let res = this.couponRestrictionsCategories;\r\n\r\n      for (var i = 0; i < res.length; i++) {\r\n        if (i != key) {\r\n          items.push(res[i]);\r\n        }\r\n      }\r\n\r\n      this.couponRestrictionsCategories = items;\r\n    },\r\n\r\n    changeRProd: function (value) {\r\n      this.resProd = value;\r\n      if (value == \"NO\") {\r\n        this.limitProducts = \"NO\";\r\n        this.ExcludeProducts = \"NO\";\r\n        this.couponRestrictionsProducts = [];\r\n      }\r\n\r\n      if (value == \"LIMITAR\") {\r\n        this.limitProducts = \"SI\";\r\n        this.ExcludeProducts = \"NO\";\r\n      }\r\n\r\n      if (value == \"EXCLUIR\") {\r\n        this.limitProducts = \"NO\";\r\n        this.ExcludeProducts = \"SI\";\r\n      }\r\n    },\r\n\r\n    añadirProd(producto) {\r\n      this.status = \"\";\r\n      this.msg = \"\";\r\n\r\n      if (this.resProd == \"NO\") {\r\n        this.status = \"error\";\r\n        this.msg =\r\n          \"Es necesario indicar el tipo de restricción (Limitar / Excluir)\";\r\n      } else if (producto == undefined || producto == \"\") {\r\n        this.status = \"error\";\r\n        this.msg = \"Agrege una categoría valida.\";\r\n      } else {\r\n        let prods = this.products;\r\n        let isvalid = \"NO\";\r\n        for (var i = 0; i < prods.length; i++) {\r\n          if (prods[i].name == producto) {\r\n            isvalid = \"SI\";\r\n          }\r\n        }\r\n\r\n        if (isvalid == \"SI\") {\r\n          let items = [];\r\n          let res = this.couponRestrictionsProducts;\r\n\r\n          for (var i = 0; i < res.length; i++) {\r\n            items.push(res[i]);\r\n          }\r\n\r\n          let encontrado = \"NO\";\r\n\r\n          for (var k = 0; k < items.length; k++) {\r\n            if (items[k] == producto) {\r\n              encontrado = \"SI\";\r\n            }\r\n          }\r\n\r\n          if (encontrado == \"NO\") {\r\n            items.push(producto);\r\n          } else {\r\n            this.status = \"error\";\r\n            this.msg = \"Producto ya agregado.\";\r\n          }\r\n\r\n          this.couponRestrictionsProducts = items;\r\n          this.prod_name = \"\";\r\n        } else {\r\n          this.status = \"error\";\r\n          this.msg = \"Producto no encontrado.\";\r\n          this.prod_name = \"\";\r\n        }\r\n      }\r\n    },\r\n\r\n    delRprod(key) {\r\n      let items = [];\r\n      let res = this.couponRestrictionsProducts;\r\n\r\n      for (var i = 0; i < res.length; i++) {\r\n        if (i != key) {\r\n          items.push(res[i]);\r\n        }\r\n      }\r\n\r\n      this.couponRestrictionsProducts = items;\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.gencode {\r\n  color: var(--color-1);\r\n  font-weight: 700;\r\n  font-size: 0.7291666666666666vw;\r\n  cursor: pointer;\r\n}\r\n.grup-form {\r\n  align-items: flex-start;\r\n}\r\n#AddCat label {\r\n  color: var(--color-2);\r\n  font-weight: 700;\r\n  font-size: 0.7291666666666666vw;\r\n  margin-bottom: 0.3vw;\r\n}\r\n\r\n#AddCat input,\r\n#AddCat select {\r\n  height: 2.5vw;\r\n  width: 14.716666666666668vw;\r\n  border: 0.052083vw solid var(--color-2);\r\n  border-radius: 0vw 1.5vw 1.5vw 0vw;\r\n  color: var(--color-4);\r\n  font-size: 0.7291666666666666vw;\r\n  font-weight: 500;\r\n  padding-left: 1.09375vw;\r\n}\r\n\r\n#select-role {\r\n  height: 2.5vw;\r\n  width: 13.716667vw;\r\n  border: 0.052083vw solid var(--color-2);\r\n  border-radius: 0vw 1.5vw 1.5vw 0vw;\r\n  color: var(--color-4);\r\n  font-size: 0.7291666666666666vw;\r\n  font-weight: 500;\r\n  padding-left: 1.09375vw;\r\n  display: flex;\r\n  align-items: center;\r\n  background-image: url(\"../../assets/blueflecha.svg\");\r\n  background-repeat: no-repeat;\r\n  background-position-y: center;\r\n  background-position-x: 12.6vw;\r\n}\r\n#select-role.rounded {\r\n  border-radius: 0vw 1.5vw 0vw 0vw;\r\n  border-left: 0.052083vw solid var(--color-2);\r\n  border-right: 0.052083vw solid var(--color-2);\r\n  border-top: 0.052083vw solid var(--color-2);\r\n  border-bottom: 0;\r\n}\r\n#select-ch:checked ~ .options-cont {\r\n  display: flex;\r\n  position: absolute;\r\n  padding: 0.573vw 1.25vw;\r\n  flex-direction: column;\r\n  background-color: white;\r\n  width: 12.3vw;\r\n  border-left: 0.052083vw solid var(--color-2);\r\n  border-right: 0.052083vw solid var(--color-2);\r\n  border-top: 0;\r\n  border-bottom: 0.052083vw solid var(--color-2);\r\n}\r\n\r\n.bodytbl-items {\r\n  width: 15vw;\r\n}\r\n\r\np.prest{\r\n  font-size: 1vw;\r\n  color: var(--color-1);\r\n  font-weight: 800;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}